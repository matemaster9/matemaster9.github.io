<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="springboot, MateMaster">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id=G-PRQHWVQTW4"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'G-PRQHWVQTW4');
</script>


    <title>springboot | MateMaster</title>
    <link rel="icon" type="image/jpeg" href="/mashimaro.jpg">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/css/aos.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/css/animate.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/matemaster9/source@3.0/matery-libs/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/js/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="MateMaster" type="application/atom+xml">
</head>



   <style>
    body{
       background-image: url(https://cdn.jsdelivr.net/gh/matemaster9/image-one/images/20210317193723.jpg);
       background-repeat:no-repeat;
       background-size:cover;
       background-attachment:fixed;
    }
</style>



<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <span class="logo-span">MateMaster</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-blog" style="zoom: 0.6;"></i>
      
      <span>Studio</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>blog</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/tags">
          
          <i class="fas fa-tag" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>æ ‡ç­¾</span>
        </a>
      </li>
      
      <li>
        <a href="/categories">
          
          <i class="fas fa-bookmark" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>åˆ†ç±»</span>
        </a>
      </li>
      
      <li>
        <a href="/archives">
          
          <i class="fas fa-history" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>æ—¥å¿—</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user" style="zoom: 0.6;"></i>
      
      <span>Master</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>BBS</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-link" style="zoom: 0.6;"></i>
      
      <span>link</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tools/cn" class="waves-effect waves-light">
      
      <i class="fas fa-location-arrow" style="zoom: 0.6;"></i>
      
      <span>web</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="æœç´¢" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <div class="logo-name">MateMaster</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-blog"></i>
			
			Studio
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			blog
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/tags " style="margin-left:75px">
				  
				   <i class="fa fas fa-tag" style="position: absolute;left:50px" ></i>
			      
		          <span>æ ‡ç­¾</span>
                  </a>
                </li>
              
                <li>

                  <a href="/categories " style="margin-left:75px">
				  
				   <i class="fa fas fa-bookmark" style="position: absolute;left:50px" ></i>
			      
		          <span>åˆ†ç±»</span>
                  </a>
                </li>
              
                <li>

                  <a href="/archives " style="margin-left:75px">
				  
				   <i class="fa fas fa-history" style="position: absolute;left:50px" ></i>
			      
		          <span>æ—¥å¿—</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user"></i>
			
			Master
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			BBS
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-link"></i>
			
			link
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tools/cn" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-location-arrow"></i>
			
			web
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    
<script src="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/js/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('è¯·è¾“å…¥è®¿é—®æœ¬æ–‡ç« çš„å¯†ç ')).toString(CryptoJS.enc.Hex)) {
                alert('å¯†ç é”™è¯¯ï¼Œå°†è¿”å›ä¸»é¡µï¼');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('https://cdn.jsdelivr.net/gh/matemaster9/ali-note/img/20210914224854.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">springboot</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/css/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail" class="diy-font">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Spring/">
                                <span class="chip bg-color">Spring</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/SpringFramework/" class="post-category">
                                SpringFramework
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp;
                    2021-01-08
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>æ›´æ–°æ—¥æœŸ:&nbsp;&nbsp;
                    2021-09-21
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>æ–‡ç« å­—æ•°:&nbsp;&nbsp;
                    14.7k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>é˜…è¯»æ—¶é•¿:&nbsp;&nbsp;
                    64 åˆ†
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>é˜…è¯»æ¬¡æ•°:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>

            <div class="info-break-policy">
                
                    <i class="fas fa-pencil-alt"></i> åŸåˆ›ä½œè€…: MateMaster
                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- æ˜¯å¦åŠ è½½ä½¿ç”¨è‡ªå¸¦çš„ prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p style="font-size: 28px">å†™åœ¨å‰é¢</p>

<p>SpringBoot é¢„æƒ³å­¦ä¹ å¾é€”ï¼š</p>
<ol>
<li>è®¤çŸ¥ã€äº†è§£<ul>
<li>çŸ¥æ™“ spring boot æ˜¯ä»€ä¹ˆï¼Ÿæ¨ªå‘æ‹“å±•æŠ€æœ¯å¹¿åº¦ï¼Œäº†è§£webåç«¯æŠ€æœ¯ï¼</li>
<li>spring æ¡†æ¶çš„æ ¸å¿ƒæ¦‚å¿µï¼šIOCå®¹å™¨ã€ AOPåˆ‡é¢</li>
<li>Spring ã€ SpringMVC ã€ SpringBoot ä¸ºä»€ä¹ˆå‡ºç°ï¼Ÿ</li>
</ul>
</li>
<li>å­¦ä¹  SpringBoot åŸºæœ¬çŸ¥è¯†ï¼ˆå­¦è¯­æ³•ã€å­¦ç”¨æ³•ï¼‰<ul>
<li>çœ‹æ­å»º demo è§†é¢‘ï¼Œèƒ½å¤Ÿå¿«é€Ÿå»ºç«‹ç®€å•demo</li>
<li>çœ‹å®˜æ–¹æ–‡æ¡£ <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/html/">spring-boot-docs</a></li>
<li>çœ‹ä¹¦ï¼šSpring5å®æˆ˜ã€ SpringBootå®æˆ˜</li>
<li>æ€»ç»“ã€å†™çŸ¥è¯†ç‚¹åšå®¢</li>
</ul>
</li>
<li>å±€éƒ¨ç»ƒä¹ ã€å°å‹å®æˆ˜ã€æ­ç¯å¢ƒ<ul>
<li>é’ˆå¯¹æ¯ä¸ªå°çŸ¥è¯†ç‚¹ï¼Œçœ‹å®˜æ–¹ç¤ºä¾‹ï¼Œè‡ªå·±ç¼–ç </li>
<li>æ¯ä¸€éƒ¨åˆ†å¯ä»¥æ­å»º å°demo <a target="_blank" rel="noopener" href="https://github.com/matemaster9/MasterStudio">GitHubä»“åº“</a></li>
<li>ç»§ç»­å†™åšå®¢ è®°å½•å‘ğŸ•³</li>
</ul>
</li>
<li>å¼€æºé¡¹ç›®ç»ƒä¹  <a target="_blank" rel="noopener" href="https://el-admin.vip/">eladmin</a><ul>
<li>ç©è½¬ï¼ˆå¸Œæœ›è‡ªå·±å°†æ¥å¼€æºç©è½¬ï¼ï¼‰æ‰€éœ€è¦çš„è®¡ç®—æœºåŸºç¡€çŸ¥è¯†</li>
<li>å¸Œæœ›æˆ‘å¯ä»¥åœ¨æ­¤å¼€æºé¡¹ç›®ä¹‹ä¸Š diy æˆ–è€…æœªæ¥å¯ä»¥è®¾è®¡å‡º å¼€æºé¡¹ç›® <a target="_blank" rel="noopener" href="https://github.com/">elmaster</a></li>
</ul>
</li>
<li>èœé€¼çš„æˆ‘å¸Œæœ›æœªæ¥å¯ä»¥é€ è½®å­ï¼Œå†™å¼€æºé¡¹ç›®ï¼æˆä¸ºå¤§ç‰›ï¼ï¼ˆæ¥è‡ªèœé¸Ÿçš„æ¢¦æƒ³ï¼‰</li>
</ol>
<h1 id="springåŸºç¡€"><a href="#springåŸºç¡€" class="headerlink" title="springåŸºç¡€"></a>springåŸºç¡€</h1><h2 id="IOC"><a href="#IOC" class="headerlink" title="IOC"></a>IOC</h2><p>é¦–å…ˆå±•ç¤ºä¸€å¼  spring æ¡†æ¶çš„ç»“æ„å›¾ï¼Œæ¥è§£é‡Š spring çš„ä¸»è¦ä½œç”¨ï¼š</p>
<img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210520090337.png">

<p>ApplicationContext:ä½œä¸ºæœ€ä¸»è¦çš„ springå®¹å™¨ï¼Œæœ‰ç€ä¸¤ä¸ªå®ç°ç±»ï¼š</p>
<ul>
<li>ClassPathXmlApplicationContext: ä»ç±»åŠ è½½è·¯å¾„ä¸‹æœç´¢é…ç½®æ–‡ä»¶ï¼Œå¹¶æ ¹æ®é…ç½®æ–‡ä»¶æ¥åˆ›å»ºSpringå®¹å™¨ã€‚</li>
<li>FileSystemXmlApplicationContext: ä»æ–‡ä»¶ç³»ç»Ÿçš„ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ä¸‹å»æœç´¢é…ç½®æ–‡ä»¶ï¼Œå¹¶æ ¹æ®é…ç½®æ–‡ä»¶æ¥åˆ›å»ºSpringå®¹å™¨ã€‚</li>
</ul>
<p>é¦–å…ˆéœ€è¦äº†è§£ä¸€ä¸ªå«åšï¼šâ€œä¾èµ–æ³¨å…¥â€ çš„æ¦‚å¿µã€‚å› ä¸ºJavaç¨‹åºé€šè¿‡ springå®¹å™¨æ¥ç®¡ç†è®¿é—®å®¹å™¨ä¸­çš„beanï¼Œå¹¶ä¸”ä»åŸæ¥çš„ â€œä¸»åŠ¨åˆ›å»ºä¾èµ–å¯¹è±¡â€ åˆ° ç°åœ¨ â€œè¢«åŠ¨çš„ç”±springå®¹å™¨å°†ç”Ÿæˆçš„ä¾èµ–å¯¹è±¡æ³¨å…¥åˆ°è°ƒç”¨è€…ä¸­â€ã€‚</p>
<p>è‡³äº IOC å’Œ DI ä¹‹é—´çš„æ¦‚å¿µåŒºåˆ«ï¼Œä¸»è¦æ˜¯ä»ä¸åŒçš„è§’åº¦æ¥è§£é‡Šè¿™ç§ä¾èµ–å…³ç³»çš„äº§ç”Ÿæ–¹å¼ã€‚ IOC ï¼šä»ä¾èµ–å¯¹è±¡çš„è·å–æ–¹å¼ï¼Œç”±ä¸»åŠ¨å˜è¢«åŠ¨ã€‚ DI ï¼š ä»springå®¹å™¨çš„è§’åº¦æ¥çœ‹ï¼Œä¾èµ–å¯¹è±¡æ˜¯å®¹å™¨æ³¨å…¥åˆ°è°ƒç”¨è€…ã€‚</p>
<p>ä¾èµ–æ³¨å…¥çš„ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li>è®¾å€¼æ³¨å…¥ï¼šåˆ©ç”¨è°ƒç”¨è€…çš„ setter æ–¹æ³•</li>
<li>æ„é€ æ³¨å…¥ï¼šåˆ©ç”¨è°ƒç”¨è€…çš„ æ„é€  æ–¹æ³•</li>
</ul>
<p>è®¾å€¼æ³¨å…¥ï¼ˆä¸»ï¼‰ï¼šè®©ä¾èµ–æ³¨å…¥æ›´åŠ æ˜æ˜¾ã€ç®€å•ï¼Œå¹¶ä¸”åœ¨ä¾èµ–å¯é€‰çš„æƒ…å†µä¸‹ï¼Œå‡å°‘äº†æ„é€ å™¨çš„è‡ƒè‚¿ã€‚</p>
<p>æ„é€ æ³¨å…¥ï¼ˆè¾…ï¼‰ï¼šå¯ä»¥æ§åˆ¶ä¾èµ–æ³¨å…¥çš„ä¼˜å…ˆçº§é¡ºåºï¼Œå¯¹äºä¾èµ–å…³ç³»ä¸å˜çš„beanæœ‰ç”¨ï¼Œå¹¶ä¸”å› ä¸ºåªè¦ç»„ä»¶åˆ›é€ è€…æ‰å¯ä»¥è§„å®šä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥å¯¹è°ƒç”¨è€…é»‘ç›’ï¼Œä¿è¯é«˜å†…èšã€‚</p>
<p><b style="font-size: 27px">Dependency Injection</b></p>
<p>ç±»ä¼¼äºä¸‹é¢çš„æ–¹å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠä¾èµ–çš„ç±»ï¼šCollaborator æ³¨å…¥åˆ° ExampleBean</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExampleBean</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Collaborator1</span> collaborator1<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Collaborator2</span> collaborator2<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">ExampleBean</span><span class="token punctuation">(</span><span class="token class-name">Collaborator1</span> collaborator1<span class="token punctuation">,</span> <span class="token class-name">Collaborator2</span> collaborator2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>collaborator1 <span class="token operator">=</span> collaborator1<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>collaborator2 <span class="token operator">=</span> collaborator2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ç„¶ï¼Œä¸Šé¢çš„æ­¥éª¤æˆ‘ä»¬åªæ˜¯å•çº¯åœ°åœ¨ç±»ä¸Šé¢å®Œæˆäº†æ³¨å…¥ï¼Œä½†æ˜¯ springå®¹å™¨ä¸çŸ¥é“è¿™ä¸€æŒ‡ä»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é…ç½®å…ƒæ•°æ®ã€‚åœ¨ä¼ ç»Ÿçš„é…ç½®æ–¹å¼ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸‰ç§æ–¹å¼</p>
<ol>
<li>æŒ‰ç…§beançš„idæ¥é…ç½®</li>
</ol>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>exampleBean<span class="token punctuation">"</span></span> <span class="token attr-name">class</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>cn.matemaster.ExampleBean<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">ref</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>collaborator1<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">ref</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>collaborator2<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!--ç­‰ä»·å†™æ³•
		&lt;constructor-arg&gt;
			&lt;ref bean = "collaborator2"/&gt;
		&lt;/constructor-arg&gt;
		--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>collaborator1<span class="token punctuation">"</span></span> <span class="token attr-name">class</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>cn.matemaster.Collaborator1<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>collaborator2<span class="token punctuation">"</span></span> <span class="token attr-name">class</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>cn.matemaster.Collaborator2<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æŒ‰ç…§æ„é€ å‡½æ•°çš„å‚æ•°ç±»å‹æ¥é…ç½®</li>
</ol>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>exampleBean<span class="token punctuation">"</span></span> <span class="token attr-name">class</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>cn.matemaster.ExampleBean<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">type</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>cn.matemaster.Collaborator1<span class="token punctuation">"</span></span> <span class="token attr-name">value</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>xxx<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">type</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>cn.matemaster.Collaborator2<span class="token punctuation">"</span></span> <span class="token attr-name">value</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>xxx<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>æŒ‰ç…§æ„é€ å‚æ•°çš„ç´¢å¼•æ¥é…ç½®ï¼Œä»¥0å¼€å§‹</li>
</ol>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>exampleBean<span class="token punctuation">"</span></span> <span class="token attr-name">class</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>cn.matemaster.ExampleBean<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">index</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">value</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>xxx<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">index</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">value</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>xxx<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>æŒ‰ç…§æ„é€ å‚æ•°çš„å½¢å‚åç§°æ¥é…ç½®</li>
</ol>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>exampleBean<span class="token punctuation">"</span></span> <span class="token attr-name">class</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>cn.matemaster.ExampleBean<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">name</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>collaborator1<span class="token punctuation">"</span></span> <span class="token attr-name">value</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>xxx<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">name</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>collaborator2<span class="token punctuation">"</span></span> <span class="token attr-name">value</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>xxx<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>é‚£ä¹ˆæˆ‘ä»¬åœ¨çœ‹çœ‹è®¾ç½®æ³¨å…¥æ—¶ï¼Œå¦‚ä½•åˆ›å»ºç±»ï¼Œé…ç½®å…ƒæ•°æ®</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExampleBean</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">AnotherBean</span> beanOne<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">YetAnotherBean</span> beanTwo<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBeanOne</span><span class="token punctuation">(</span><span class="token class-name">AnotherBean</span> beanOne<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>beanOne <span class="token operator">=</span> beanOne<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBeanTwo</span><span class="token punctuation">(</span><span class="token class-name">YetAnotherBean</span> beanTwo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>beanTwo <span class="token operator">=</span> beanTwo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setIntegerProperty</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>i <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é…ç½®å…ƒæ•°æ®</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>exampleBean<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>examples.ExampleBean<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- setter injection using the nested ref element --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>beanOne<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ref</span> <span class="token attr-name">bean</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>anotherExampleBean<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- setter injection using the neater ref attribute --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>beanTwo<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>yetAnotherBean<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>integerProperty<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>anotherExampleBean<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>examples.AnotherBean<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>yetAnotherBean<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>examples.YetAnotherBean<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>springå®¹å™¨åˆ›å»ºbeançš„ä¸‰ç§æ–¹å¼ï¼š</p>
<ul>
<li>æ„é€ å™¨åˆ›å»ºbeanå®ä¾‹</li>
<li>é™æ€å·¥å‚æ–¹æ³•åˆ›å»ºbeanå®ä¾‹</li>
<li>å®ä¾‹å·¥å‚æ–¹æ³•åˆ›å»ºbeanå®ä¾‹</li>
</ul>
<p>springå­˜åœ¨è‡ªåŠ¨è¢«æ ‡è¯†ä¸ºbeançš„åŸºæœ¬æ³¨è§£ï¼š@Componentã€@Controllerã€@Serviceã€@Repository</p>
<p>springå®¹å™¨çš„é¢„è§ˆï¼š</p>
<ol>
<li>å¦‚ä½•é…ç½®å…ƒæ•°æ®ï¼Ÿå…ƒæ•°æ®çš„ä½œç”¨ï¼Ÿ</li>
<li>å¦‚ä½•åˆå§‹åŒ–springå®¹å™¨ï¼Ÿ</li>
<li>å¦‚ä½•ä½¿ç”¨springå®¹å™¨ï¼Ÿ</li>
</ol>
<p>é’ˆå¯¹ï¼ˆ1ï¼‰å› ä¸ºä»¥å‰éƒ½æ˜¯xmlé…ç½®å…ƒæ•°æ®ï¼Œè´¼çƒ¦ã€‚ç°åœ¨ spring boot é‡‡å–çº¦å®šå¤§äºé…ç½®çš„ç”¨æ³•ï¼Œæˆ‘ä»¬å°±éœ€è¦å¤šä½¿ç”¨å‡ ä¸ªä¸å«å¸¸ç”¨çš„beanæ³¨è§£ï¼Œå°±å¯ä»¥é…ç½®ç›¸å…³çš„bean</p>
<p>é’ˆå¯¹ï¼ˆ2ï¼‰ä»¥å‰éƒ½æ˜¯ SpringContext æ¥å£çš„å®ç°ç±»å–è¯»å–é…ç½®çš„å…ƒæ•°æ®æ¥åˆ›å»ºå®ç°ç±»çš„å®ä¾‹ï¼Œç°åœ¨ springbootè‡ªåŠ¨å®Œæˆåˆå§‹åŒ–ï¼</p>
<p>é’ˆå¯¹ï¼ˆ3ï¼‰å¯ä»¥ä½¿ç”¨ SpringContext æ¥å£çš„å®ç°ç±»è·å–å®¹å™¨å®ä¾‹ã€‚</p>
<p>ä¸‹é¢åœ¨spring bootä¸­è·å–å¯¹åº”çš„å®¹å™¨å®ä¾‹ï¼Œå¹¶ä¸”åˆ©ç”¨å®¹å™¨è·å–å®¹å™¨ä¸­çš„bean-&gt;car</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConfigurableApplicationContext</span> run <span class="token operator">=</span> <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">DemoApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Car</span> car <span class="token operator">=</span> run<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">Car</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        car<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é¢å‘åˆ‡é¢ç¼–ç¨‹ç¤ºä¾‹ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Aspect</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JImplAspect</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">"execution (* cn.matemaster.demo.bean.Car.print())"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">"demo()"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"åœ¨è¿™é‡Œæ’å…¥ä»£ç ï¼yyds"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><b style="font-size:27px">Javaé…ç½®ç±»</b></p>
<p>åœ¨ä½¿ç”¨Javaç±»æ¥æ³¨è§£ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°@Configurationæ³¨è§£ï¼Œå¹¶ä¸”ä½¿ç”¨@Beanæ¥æ ‡æ³¨æ¯ä¸€ä¸ªé…ç½®é¡¹ã€‚æ¯ä¸€ä¸ªbeançš„idå°†ä¸æ–¹æ³•åä¿æŒä¸€è‡´</p>
<p>æ¯”å¦‚åœ¨å¼€æºé¡¹ç›®eladminä¸­å…³äºwebmvcçš„é…ç½®ï¼</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableWebMvc</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigurerAdapter</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>

    <span class="token comment">/** æ–‡ä»¶é…ç½® */</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">FileProperties</span> properties<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">ConfigurerAdapter</span><span class="token punctuation">(</span><span class="token class-name">FileProperties</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>properties <span class="token operator">=</span> properties<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">CorsFilter</span> <span class="token function">corsFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UrlBasedCorsConfigurationSource</span> source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UrlBasedCorsConfigurationSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CorsConfiguration</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CorsConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">setAllowCredentials</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">addAllowedOrigin</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">addAllowedHeader</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">addAllowedMethod</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        source<span class="token punctuation">.</span><span class="token function">registerCorsConfiguration</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CorsFilter</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
	<span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configureMessageConverters</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HttpMessageConverter</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> converters<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ä½¿ç”¨ fastjson åºåˆ—åŒ–ï¼Œä¼šå¯¼è‡´ @JsonIgnore å¤±æ•ˆï¼Œå¯ä»¥ä½¿ç”¨ @JSONField(serialize = false) æ›¿æ¢</span>
        <span class="token class-name">FastJsonHttpMessageConverter</span> converter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FastJsonHttpMessageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MediaType</span><span class="token punctuation">&gt;</span></span> supportMediaTypeList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        supportMediaTypeList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span>APPLICATION_JSON_UTF8<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FastJsonConfig</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FastJsonConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">setDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">setSerializerFeatures</span><span class="token punctuation">(</span><span class="token class-name">SerializerFeature<span class="token punctuation">.</span>DisableCircularReferenceDetect</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        converter<span class="token punctuation">.</span><span class="token function">setFastJsonConfig</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
        converter<span class="token punctuation">.</span><span class="token function">setSupportedMediaTypes</span><span class="token punctuation">(</span>supportMediaTypeList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        converter<span class="token punctuation">.</span><span class="token function">setDefaultCharset</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">;</span>
        converters<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>converter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è™½ç„¶ä½¿ç”¨Javaé…ç½®ç±»ï¼Œä¸šåŠ¡é€»è¾‘å¾ˆæ¸…æ™°ï¼Œä½†æ˜¯é…ç½®é¡¹å°†ä¼šéå¸¸åˆ†æ•£ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åŒçš„é…ç½®ç±»åœ¨ä¸åŒçš„åŒ…ä¸‹ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨æŸ¥è¯¢è‡ªå·±çš„é…ç½®ä¿¡æ¯æ—¶å°±ä¼šå‡ºç°æ‰¾ä¸åˆ°çš„æƒ…å†µï¼Œä¸ºäº†é¿å…ã€‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ ¹é…ç½®ç±»ï¼Œå¹¶ä¸”å°†å…¶ä»–åˆ†æ•£çš„é…ç½®ç±»å…¨éƒ¨å¯¼å…¥åˆ°æ ¹é…ç½®ç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">OtherConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RootConfig</span> <span class="token punctuation">{</span>
    
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h2><h1 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h1><h2 id="ä¾èµ–ç®¡ç†"><a href="#ä¾èµ–ç®¡ç†" class="headerlink" title="ä¾èµ–ç®¡ç†"></a>ä¾èµ–ç®¡ç†</h2><p><code>Springboot</code>çš„ä¾èµ–ç®¡ç†æ˜¯ä¾æ®ä¸€ç³»åˆ—çš„<strong>åœºæ™¯å¯åŠ¨å™¨</strong>ï¼Œè€Œç®¡ç†è¿™äº›å¯åŠ¨å™¨ç‰ˆæœ¬çš„å°±æ˜¯ä¸‹é¢çš„pomçˆ¶é¡¹ç›®</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.2.10.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ç„¶å®˜æ–¹ä¹Ÿæä¾›äº†ä¸ä½¿ç”¨<code>spring-boot-starter-parent</code>çš„æ–¹å¼ï¼Œè¿™é‡Œæš‚æ—¶ä¸å­¦ï¼</p>
<p><code>&lt;parent&gt;</code>æ ‡ç­¾ç®¡ç†äº†æ‰€æœ‰å¯åŠ¨å™¨ï¼Œæ‰€åŸºäºçš„spring bootç‰ˆæœ¬ã€‚å‡è®¾ç°åœ¨å¼€å‘webé¡¹ç›®ï¼Œæˆ‘ä»¬å¯¼å…¥ç›¸å…³çš„å¯åŠ¨å™¨</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!--Spring boot Webä¾èµ–--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é€šè¿‡åœºæ™¯å¯åŠ¨å™¨spring bootè‡ªåŠ¨å¯¼å…¥ä¸webç›¸å…³çš„æ‰€æœ‰ä¾èµ–ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®ä¾èµ–ä¼ é€’æ€§æ‰¾çš„è¯¥spring bootç‰ˆæœ¬ä¸‹æ‰€å…³è”çš„webä¾èµ–ç‰ˆæœ¬</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>æ‰€å…³è”çš„ç‰ˆæœ¬<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>ä¸€èˆ¬æƒ…å†µä¸‹å®˜æ–¹çš„å¯åŠ¨å™¨ç‰ˆæœ¬å‘½åæ–¹å¼ä¸ºï¼š</li>
</ul>
<p><code>spring-boot-starter-officalxxx</code></p>
<ul>
<li>è‡ªå®šä¹‰çš„å¯åŠ¨å™¨å‘½åæ–¹å¼ä¸ºï¼š</li>
</ul>
<p><code>thirdpartyproject-sring-boot-starter</code></p>
<p>å½“ç„¶åœºæ™¯å¯åŠ¨å™¨å¼•å…¥çš„ä¾èµ–ç‰ˆæœ¬æœ‰æ—¶å€™å¯èƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç‰ˆæœ¬ï¼Œä¸ºäº†å¯ä»¥ä½¿ç”¨è‡ªå·±çš„ä¾èµ–ç‰ˆæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šé¢<code>spring-boot-dependencies</code>çš„<code>properties</code>æ ‡ç­¾ä¸‹çš„keyå–å®šä¹‰è‡ªå·±çš„ç‰ˆæœ¬ï¼Œ<strong>æ³¨æ„ç‰ˆæœ¬å…¼å®¹çš„é—®é¢˜</strong>ã€‚ä¸¾ä¸ªæ —å­ï¼šæˆ‘ç°åœ¨æƒ³ä½¿ç”¨è‡ªå·±çš„MySQLç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯å¯åŠ¨å™¨è‡ªå¸¦çš„ç‰ˆæœ¬ï¼Œæˆ‘å°±æŒ‰ç…§ä¸Šé¢çš„æç¤ºæ‰¾åˆ°keyï¼Œç„¶åæ”¹æˆè‡ªå·±æƒ³è¦çš„ç‰ˆæœ¬ã€‚å°†8.0.21æ”¹ä¸º5.1.13</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!--åœ¨å¯¹åº”çš„pom.xmlä¸­ä¿®æ”¹--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mysql.version</span><span class="token punctuation">&gt;</span></span>5.1.13<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mysql.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®˜æ–¹æä¾›äº†ä¸€ä¸ªå…³äºmavençš„æ’ä»¶ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨<code>spring-boot-starter-parent</code>é¡¹ç›®æ—¶ï¼Œå¯ä»¥ç›´æ¥å¯¼å…¥è¿™ä¸ªæ’ä»¶ä¾èµ–ï¼Œå°†æˆ‘ä»¬æœªæ¥çš„spring booté¡¹ç›®æ‰“åŒ…æˆjaræ–‡ä»¶ <strong>æ‰“åŒ…æ’ä»¶</strong></p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="è‡ªåŠ¨é…ç½®"><a href="#è‡ªåŠ¨é…ç½®" class="headerlink" title="è‡ªåŠ¨é…ç½®"></a>è‡ªåŠ¨é…ç½®</h2><p>æˆ‘ä»¬ä»¥<code>spring-boot-starter-web</code>ä¸ºä¾‹ï¼Œwebå¯åŠ¨å™¨æ˜¯å¦‚ä½•å®Œæˆï¼Œä¾èµ–å¯¼å…¥ä»¥åŠè‡ªåŠ¨è£…é…çš„ä»»åŠ¡ï¼Ÿ</p>
<p>Structuring Your Codeï¼ˆå®˜æ–¹æ–‡æ¡£ï¼‰</p>
<p>å»ºè®®æˆ‘ä»¬åº”è¯¥å°†ä»£ç éƒ½æ”¾åœ¨ä¸»ç±»çš„åŒçº§å­åŒ…ä¸‹ã€‚å› ä¸ºè¢«<code>@SpringBootApplication</code>æ³¨è§£çš„ä¸»ç±»ï¼Œè¯¥æ³¨è§£èµ‹äºˆäº†ä¸€ç§è‡ªåŠ¨æ‰«æçš„åŠŸèƒ½ï¼Œè¿™æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼</p>
<p>@SpringBootApplication</p>
<ul>
<li>@SpringBootConfiguration</li>
<li>@EnableAutoConfiguration</li>
<li>@ComponentScan</li>
</ul>
<p>å›åˆ°ä¸Šé¢è®²çš„åŒ…æ‰«æï¼Œæ‰€æœ‰åœ¨ä¸»ç±»çš„åŒçº§å­åŒ…ä¸‹éƒ½å¯ä»¥é»˜è®¤è¢«æ‰«æåˆ°ã€‚å½“ç„¶å®˜æ–¹ä¹Ÿä¸æ˜¯è¯´ä¸è®²ç†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰æ‰«æçš„è·¯å¾„ï¼š</p>
<p>â‘ ä½¿ç”¨scanBasePackagesæ–¹æ³•</p>
<p><strong>@SpringBootApplication(scanBasePackages = â€œåŒ…è·¯å¾„â€)</strong></p>
<p>â‘¡å› ä¸ºè¿™æ˜¯ä¸ªç»„åˆæ³¨è§£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ä¸Šé¢ä¸‰ä¸ªæ³¨è§£ä»£æ›¿è¿™ä¸ªæ³¨è§£ï¼Œå¹¶ä¸”åˆ©ç”¨@ComponentScanè‡ªå®šä¹‰è·¯å¾„</p>
<p><strong>@ComponentScan(â€œåŒ…è·¯å¾„â€)</strong></p>
<p>å®˜æ–¹å»ºè®®çš„ç»“æ„</p>
<pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">com
 +- example
     +- myapplication
         +- Application.java
         |
         +- customer
         |   +- Customer.java
         |   +- CustomerController.java
         |   +- CustomerService.java
         |   +- CustomerRepository.java
         |
         +- order
             +- Order.java
             +- OrderController.java
             +- OrderService.java
             +- OrderRepository.java<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>@EnableAutoConfiguration</code>ï¼š<strong>å®Œæˆè‡ªåŠ¨é…ç½®ä»»åŠ¡</strong>ï¼</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@AutoConfigurationPackage</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">AutoConfigurationImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">EnableAutoConfiguration</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> ENABLED_OVERRIDE_PROPERTY <span class="token operator">=</span> <span class="token string">"spring.boot.enableautoconfiguration"</span><span class="token punctuation">;</span>

    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">exclude</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>   <span class="token comment">// æŒ‰ç±»å‹æ’é™¤</span>

    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">excludeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// æŒ‰åç§°æ’é™¤</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å…³äºé…ç½®å±æ€§çš„é»˜è®¤å€¼ï¼Œä»¥åŠå¦‚ä½•ä¿®æ”¹é…ç½®çš„å€¼ï¼Ÿ</p>
<p>ä¸€èˆ¬æƒ…å†µé…ç½®å±æ€§éƒ½ä¼šæœ‰æ‹¥æœ‰è€…ï¼Œä¹Ÿå°±æ˜¯é…ç½®å±æ€§ç»‘å®šçš„Javaç±»ã€‚éœ€è¦äº†è§£çš„å°±æ˜¯å¦‚ä½•å°†é…ç½®å±æ€§ç»‘å®šåˆ°ç±»ä¸Šï¼Œä»¥åŠæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨ç›¸å…³çš„é…ç½®å±æ€§ï¼</p>
<p>å¯åŠ¨å™¨æ˜¯æŒ‰éœ€åŠ è½½æ‰€æœ‰é…ç½®é¡¹ï¼š</p>
<ol>
<li>æŒ‰ç…§æˆ‘ä»¬å¼•å…¥çš„starteråŠ è½½ç›¸å…³çš„é…ç½®</li>
<li>spring bootæ‰€æœ‰å…³äºè‡ªåŠ¨é…ç½®çš„åŠŸèƒ½éƒ½åœ¨åŒ…ï¼šspring-boot-autoconfigure</li>
</ol>
<h2 id="åº•å±‚æ³¨è§£"><a href="#åº•å±‚æ³¨è§£" class="headerlink" title="åº•å±‚æ³¨è§£"></a>åº•å±‚æ³¨è§£</h2><p><code>@Configuration</code>é…ç½®æ³¨è§£ï¼Œè¢«æ³¨è§£çš„ç±»å°†æˆä¸ºé…ç½®ç±»ï¼Œå®ƒä¸»è¦å­˜åœ¨ä¸¤ç§æ¨¡å¼ï¼š</p>
<ul>
<li>Full mode (proxyBeanMethods = true)</li>
<li>Lite mode (proxyBeanMethods = false)</li>
</ul>
<p>Full modeä¸‹ï¼Œspring bootå°†ä¼šå°†æ­¤IOCå®¹å™¨ä¸­æ˜¯å¦å­˜åœ¨è¯¥ç»„ä»¶ï¼Œå¦‚æœå­˜åœ¨å°±ä¼šè¿”å›è¯¥ç»„ä»¶ï¼Œä¿æŒå•åˆ—</p>
<p>Lite modeä¸‹ï¼Œspring bootå°†è·³è¿‡æ£€æŸ¥ç¯èŠ‚ï¼Œä¸åœ¨ä¿æŒå•åˆ—</p>
<p><strong>@Configuration</strong>å‘Šè¯‰spring bootæ­¤ç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œç›¸å½“äºé…ç½®æ–‡ä»¶</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">cn<span class="token punctuation">.</span>matemaster<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>matemaster<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">Pet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>matemaster<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">User</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">user01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"matemaster"</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Pet</span> <span class="token function">tomcat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Pet</span><span class="token punctuation">(</span><span class="token string">"tom"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æè¿°ä¸€ä¸ªå¯¹è±¡ä¸ºç»„ä»¶çš„æ³¨è§£ï¼š</p>
<p>@Beanã€@Componentã€@Controllerã€@Serviceã€@Repository</p>
<p>ç»„ä»¶æ‰«æä»¥åŠå¯¼å…¥ï¼š</p>
<p>@Componentã€@Import</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">cn<span class="token punctuation">.</span>matemaster<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">ch<span class="token punctuation">.</span>qos<span class="token punctuation">.</span>logback<span class="token punctuation">.</span>core<span class="token punctuation">.</span>db<span class="token punctuation">.</span></span><span class="token class-name">DBHelper</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>matemaster<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">Pet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>matemaster<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">User</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Import</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">DBHelper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">"MateMaster"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">user01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"matemaster"</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Pet</span> <span class="token function">tomcat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Pet</span><span class="token punctuation">(</span><span class="token string">"tom"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>@Import</code>ä¸ºspring bootå¯¼å…¥ç»„ä»¶ï¼Œå®ƒæ¥å—classç±»å‹çš„æ•°ç»„æ¥å®¹çº³ç»„ä»¶ï¼š</p>
<p><strong>@Import({User.class, DBHelper.class})</strong></p>
<p>@Importè®©spring bootè°ƒç”¨Userã€DBhelperçš„<strong>æ— å‚æ„é€ å™¨</strong>å»åˆ›å»ºç»„ä»¶å¯¹è±¡ï¼ŒåŠ å…¥åˆ°å®¹å™¨ä¸­</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">cn<span class="token punctuation">.</span>matemaster<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>matemaster<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">Pet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>matemaster<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">User</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>matemaster<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">MyConfig</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">ConfigurableApplicationContext</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConfigurableApplicationContext</span> run <span class="token operator">=</span> <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">DemoApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> beanNamesForType <span class="token operator">=</span> run<span class="token punctuation">.</span><span class="token function">getBeanNamesForType</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> s <span class="token operator">:</span> beanNamesForType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/*	console:
 *		cn.matemaster.demo.bean.User
 *		MateMaster
 *
 */</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>@Conditional</code>å½“æ»¡è¶³å…¶æ¡ä»¶æ—¶ï¼Œåˆ™è¿›è¡Œç»„ä»¶æ³¨å…¥ã€‚ä»–ä½œä¸ºæ ¹æ³¨è§£è¿˜å­˜åœ¨ä¸€ç³»åˆ—çš„<strong>æ‹“å±•æ³¨è§£</strong></p>
<p><strong>æ ¸å¿ƒï¼šæŒ‰æ¡ä»¶æ³¨å…¥</strong></p>
<p>å› ä¸ºspring bootä¸»è¦æ˜¯çº¦å®šå¤§äºé…ç½®ï¼Œä½†æ˜¯ä¹Ÿæ˜¯æ”¯æŒé…ç½®çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¾æ—§å¯ä»¥ä½¿ç”¨xmlæ¥é…ç½®æˆ‘ä»¬çš„ç»„ä»¶ï¼Œé‚£ä¹ˆå¦‚ä½•æ¥ä½¿ç”¨xmlé…ç½®ï¼Ÿ</p>
<p><code>@ImportResource</code>è§£å†³xmlé…ç½®ç»„ä»¶çš„é—®é¢˜ï¼š</p>
<p>**@ImportResource(â€œclasspath: beans.xmlâ€)**ã€‚beans.xmlåˆ©ç”¨xmlæ–¹å¼é…ç½®äº†ä¸€äº›ç»„ä»¶ï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨è¯¥æ³¨è§£å®Œæˆç»„ä»¶æ³¨å…¥å®¹å™¨çš„ä»»åŠ¡ï¼</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨<code>application.yml</code>é…ç½®æ–‡ä»¶ï¼Œæ¥å®Œæˆå¯¹spring bootå±æ€§çš„é…ç½®ä»»åŠ¡ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è·å–ä¸Šé¢é…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Ÿ</p>
<p>ç­”ï¼š<code>@ConfigurationProperties</code>æ³¨è§£å°±å¯ä»¥è¯»å–åˆ°é…ç½®æ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼Œä¾‹å¦‚ <strong>@ConfigurationProperties(prefix = â€œå±æ€§å‰ç¼€â€)</strong></p>
<p><code>application.yml</code>çš„å†…å®¹ï¼š</p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">mycar</span><span class="token punctuation">:</span>
  <span class="token key atrule">brand</span><span class="token punctuation">:</span> HW
  <span class="token key atrule">price</span><span class="token punctuation">:</span> <span class="token number">1000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>â‘  @Component + @ConfigurationProperties(prefix = â€œå±æ€§å‰ç¼€â€)</p>
<p>åœ¨ç»„ä»¶ç±»ä¸Šï¼Œå…ˆå°†ç±»æ³¨å†Œä¸ºspringç»„ä»¶ï¼Œç„¶åè¯¥ç»„ä»¶å°±å¯ä»¥ä½¿ç”¨@ConfigurationPropertiesçš„åŠŸèƒ½</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"mycar"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span>
	
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>â‘¡ @EnableConfigurationProperties(é…ç½®ç±».class) + @ConfigurationProperties(prefix = â€œå±æ€§å‰ç¼€â€)</p>
<p>åœ¨é…ç½®ç±»ä¸Šï¼Œå…ˆå°†éœ€è¦å¼€å¯å±æ€§é…ç½®çš„ç±»å¼€å¯ï¼Œç„¶åå†ä½¿ç”¨@ConfigurationPropertiesçš„åŠŸèƒ½ã€‚ä¸€èˆ¬é€‚åˆç¬¬ä¸‰æ–¹ä¸æ˜¯springçš„ç»„ä»¶</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">Car</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConfig</span> <span class="token punctuation">{</span>
    
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"mycar"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span>
	
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªæ§åˆ¶å™¨ï¼Œæ¥æµ‹è¯•caræ‰€æ‹¥æœ‰çš„é»˜è®¤å€¼ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebController</span> <span class="token punctuation">{</span>

    <span class="token class-name">Car</span> car<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">WebController</span><span class="token punctuation">(</span><span class="token class-name">Car</span> car<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>car <span class="token operator">=</span> car<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/car"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Car</span> <span class="token function">getCar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> car<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// æµè§ˆå™¨çš„è¾“å‡º: {brand = HW, price = 1000}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œç®€å•æä¸€ä¸‹<code>@RestController</code>å®ƒæ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼š@Controller + @Responcebodyã€‚</p>
<ul>
<li>@Controllerï¼šå°†Javaç±»è®¾ç½®ä¸ºæ§åˆ¶å™¨</li>
<li>@Responcebodyï¼šåç«¯ä¸åœ¨å°†æ•°æ®ä¼ ç»™ä¸€ä¸ªæ¨¡å‹ï¼Œå†ä¼ é€’ç»™è§†å›¾ã€‚è€Œæ˜¯ç›´æ¥è¿”å›ç»™æµè§ˆå™¨å®ä½“ã€‚</li>
</ul>
<h2 id="è‡ªåŠ¨é‡å¯"><a href="#è‡ªåŠ¨é‡å¯" class="headerlink" title="è‡ªåŠ¨é‡å¯"></a>è‡ªåŠ¨é‡å¯</h2><p>å½“æˆ‘ä»¬åœ¨ç¼–å†™spring booté¡¹ç›®çš„æ—¶å€™ï¼Œå› ä¸ºå±€éƒ¨ä¿®æ”¹äº†ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªåŠ¨é‡å¯çš„åŠŸèƒ½æ¥æ›´æ–°é¡¹ç›®ã€‚</p>
<p>é¦–å…ˆå°±æ˜¯å¼•å…¥<code>dev-tools</code></p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯¼å…¥<code>dev-tools</code>ä¹‹åï¼Œä¸‹æ¬¡ä¿®æ”¹ä»£ç çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥<code>crtl+f9</code>å³å¯é‡æ–°æ›´æ–°</p>
<h1 id="æ ¸å¿ƒåŠŸèƒ½"><a href="#æ ¸å¿ƒåŠŸèƒ½" class="headerlink" title="æ ¸å¿ƒåŠŸèƒ½"></a>æ ¸å¿ƒåŠŸèƒ½</h1><h2 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h2><p>ä¸»è¦åˆ†ä¸ºä¸¤ç§é…ç½®æ–‡ä»¶çš„å½¢å¼ï¼š<code>application.properties</code>å’Œ<code>application.yml</code></p>
<p><strong>ymlé€‚åˆä»¥æ•°æ®ä¸ºä¸­å¿ƒçš„é…ç½®æ–‡ä»¶</strong></p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8000</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">freemarker</span><span class="token punctuation">:</span>
    <span class="token key atrule">check-template-location</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
  <span class="token key atrule">profiles</span><span class="token punctuation">:</span>
    <span class="token key atrule">active</span><span class="token punctuation">:</span> dev
  <span class="token key atrule">jackson</span><span class="token punctuation">:</span>
    <span class="token key atrule">time-zone</span><span class="token punctuation">:</span> GMT+8
  <span class="token key atrule">data</span><span class="token punctuation">:</span>
    <span class="token key atrule">redis</span><span class="token punctuation">:</span>
      <span class="token key atrule">repositories</span><span class="token punctuation">:</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>

  <span class="token comment">#é…ç½® Jpa</span>
  <span class="token key atrule">jpa</span><span class="token punctuation">:</span>
    <span class="token key atrule">properties</span><span class="token punctuation">:</span>
      <span class="token key atrule">hibernate</span><span class="token punctuation">:</span>
        <span class="token key atrule">ddl-auto</span><span class="token punctuation">:</span> none
        <span class="token key atrule">dialect</span><span class="token punctuation">:</span> org.hibernate.dialect.MySQL5InnoDBDialect
    <span class="token key atrule">open-in-view</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>

  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token comment">#æ•°æ®åº“ç´¢å¼•</span>
    <span class="token key atrule">database</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>REDIS_DB<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">}</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>REDIS_HOST<span class="token punctuation">:</span>127.0.0.1<span class="token punctuation">}</span>
    <span class="token key atrule">port</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>REDIS_PORT<span class="token punctuation">:</span><span class="token number">6379</span><span class="token punctuation">}</span>
    <span class="token key atrule">password</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>REDIS_PWD<span class="token punctuation">:</span><span class="token punctuation">}</span>
    <span class="token comment">#è¿æ¥è¶…æ—¶æ—¶é—´</span>
    <span class="token key atrule">timeout</span><span class="token punctuation">:</span> <span class="token number">5000</span>

<span class="token key atrule">task</span><span class="token punctuation">:</span>
  <span class="token key atrule">pool</span><span class="token punctuation">:</span>
    <span class="token comment"># æ ¸å¿ƒçº¿ç¨‹æ± å¤§å°</span>
    <span class="token key atrule">core-pool-size</span><span class="token punctuation">:</span> <span class="token number">10</span>
    <span class="token comment"># æœ€å¤§çº¿ç¨‹æ•°</span>
    <span class="token key atrule">max-pool-size</span><span class="token punctuation">:</span> <span class="token number">30</span>
    <span class="token comment"># æ´»è·ƒæ—¶é—´</span>
    <span class="token key atrule">keep-alive-seconds</span><span class="token punctuation">:</span> <span class="token number">60</span>
    <span class="token comment"># é˜Ÿåˆ—å®¹é‡</span>
    <span class="token key atrule">queue-capacity</span><span class="token punctuation">:</span> <span class="token number">50</span>

<span class="token comment">#ä¸ƒç‰›äº‘</span>
<span class="token key atrule">qiniu</span><span class="token punctuation">:</span>
  <span class="token comment"># æ–‡ä»¶å¤§å° /M</span>
  <span class="token key atrule">max-size</span><span class="token punctuation">:</span> <span class="token number">15</span>

<span class="token comment">#é‚®ç®±éªŒè¯ç æœ‰æ•ˆæ—¶é—´/ç§’</span>
<span class="token key atrule">code</span><span class="token punctuation">:</span>
  <span class="token key atrule">expiration</span><span class="token punctuation">:</span> <span class="token number">300</span>

<span class="token comment">#å¯†ç åŠ å¯†ä¼ è¾“ï¼Œå‰ç«¯å…¬é’¥åŠ å¯†ï¼Œåç«¯ç§é’¥è§£å¯†</span>
<span class="token key atrule">rsa</span><span class="token punctuation">:</span>
  <span class="token key atrule">private_key</span><span class="token punctuation">:</span> xxxxx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬åœ¨å®šä¹‰é…ç½®ç±»æ—¶ï¼Œä¸ºäº†æ–¹ä¾¿å¯ä»¥å¼•å…¥ä¸€ä¸ªè‡ªåŠ¨é…ç½®æç¤ºæ’ä»¶<code>spring-boot-configuration-processor</code></p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-configuration-processor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--æ‰“åŒ…æ—¶è·³è¿‡è¯¥æ’ä»¶--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>excludes</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclude</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-configuration-processor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclude</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>excludes</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="webå¼€å‘"><a href="#webå¼€å‘" class="headerlink" title="webå¼€å‘"></a>webå¼€å‘</h2><h3 id="å®˜æ–¹æ–‡æ¡£webæè¿°"><a href="#å®˜æ–¹æ–‡æ¡£webæè¿°" class="headerlink" title="å®˜æ–¹æ–‡æ¡£webæè¿°"></a>å®˜æ–¹æ–‡æ¡£webæè¿°</h3><p>ä¸¤ä¸ªwebå¼€å‘åœºæ™¯ï¼š<code>spring-boot-starter-web</code>å’Œ<code>spring-boot-starter-webflux</code>ã€‚ä¸€èˆ¬ä¼šwebåº”ç”¨å’Œå“åº”å¼webåº”ç”¨ã€‚</p>
<p><b style="font-size:28px">Spring MVC Auto-configuration</b></p>
<hr>
<p><b style="font-size:24px">spring mvcçš„é»˜è®¤é…ç½®</b></p>
<p>Spring Boot provides auto-configuration for Spring MVC that works well with most applications.</p>
<p><strong>é»˜è®¤æ”¯æŒè‡ªåŠ¨é…ç½®æœåŠ¡</strong></p>
<p>The auto-configuration adds the following features on top of Springâ€™s defaults:</p>
<ul>
<li>Inclusion of <code>ContentNegotiatingViewResolver</code> and <code>BeanNameViewResolver</code> beans. <strong>â€œæ”¯æŒå†…å®¹åå•†è§†å›¾è§£æå™¨ã€BeanNameè§†å›¾è§£æå™¨â€</strong></li>
<li>Support for serving static resources, including support for WebJars (covered <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.2.10.RELEASE/reference/html/spring-boot-features.html#boot-features-spring-mvc-static-content">later in this document</a>)). <strong>â€œæ”¯æŒé™æ€èµ„æºâ€</strong></li>
<li>Automatic registration of <code>Converter</code>, <code>GenericConverter</code>, and <code>Formatter</code> beans. <strong>â€œè‡ªåŠ¨æ³¨å†ŒConverterã€GenericConverterã€Formatterçš„beanâ€</strong></li>
<li>Support for <code>HttpMessageConverters</code> (covered <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.2.10.RELEASE/reference/html/spring-boot-features.html#boot-features-spring-mvc-message-converters">later in this document</a>).</li>
<li>Automatic registration of <code>MessageCodesResolver</code> (covered <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.2.10.RELEASE/reference/html/spring-boot-features.html#boot-features-spring-message-codes">later in this document</a>).<strong>â€œå›½é™…åŒ–â€</strong></li>
<li>Static <code>index.html</code> support. <strong>â€œç³»ç»Ÿä¸»é¡µâ€</strong></li>
<li>Custom <code>Favicon</code> support (covered <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.2.10.RELEASE/reference/html/spring-boot-features.html#boot-features-spring-mvc-favicon">later in this document</a>).</li>
<li>Automatic use of a <code>ConfigurableWebBindingInitializer</code> bean (covered <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.2.10.RELEASE/reference/html/spring-boot-features.html#boot-features-spring-mvc-web-binding-initializer">later in this document</a>).</li>
</ul>
<p><strong>å®šåˆ¶åŒ–æ“ä½œï¼š</strong></p>
<p>If you want to keep those Spring Boot MVC customizations and make more <a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/5.2.9.RELEASE/spring-framework-reference/web.html#mvc">MVC customizations</a> (interceptors, formatters, view controllers, and other features), you can add your own <code>@Configuration</code> class of type <code>WebMvcConfigurer</code> but <strong>without</strong> <code>@EnableWebMvc</code>. <strong>â€œä½¿ç”¨@Confiruration + WebMvcConfigurerè‡ªå®šä¹‰è§„åˆ™â€</strong></p>
<p>If you want to provide custom instances of <code>RequestMappingHandlerMapping</code>, <code>RequestMappingHandlerAdapter</code>, or <code>ExceptionHandlerExceptionResolver</code>, and still keep the Spring Boot MVC customizations, you can declare a bean of type <code>WebMvcRegistrations</code> and use it to provide custom instances of those components. <strong>â€œä½¿ç”¨WebMvcRegistrationsä¿®æ”¹é»˜è®¤åº•å±‚ç»„ä»¶â€</strong></p>
<p>If you want to take complete control of Spring MVC, you can add your own <code>@Configuration</code> annotated with <code>@EnableWebMvc</code>, or alternatively add your own <code>@Configuration</code>-annotated <code>DelegatingWebMvcConfiguration</code> as described in the Javadoc of <code>@EnableWebMvc</code>. <strong>â€œä½¿ç”¨@Configuration + @EnableWebMvc + DelegatingWebMvcConfigurationå…¨é¢æ§åˆ¶mvcâ€</strong></p>
<hr>
<p><b style="font-size:24px">å®ç°é™æ€èµ„æºçš„è‡ªåŠ¨é…ç½®ï¼Œä»¥åŠè‡ªå®šä¹‰è®¿é—®è·¯å¾„åŠèµ„æºç›®å½•è·¯å¾„</b></p>
<p>å­¦ä¹ ç›®æ ‡ï¼š</p>
<ol>
<li>é…ç½®é™æ€èµ„æºçš„å­˜å‚¨è·¯å¾„</li>
<li>å®šä¹‰è®¿é—®é™æ€èµ„æºçš„å‰ç¼€</li>
<li>ç†Ÿç»ƒå®˜æ–¹ç»™å‡ºçš„é»˜è®¤è‡ªåŠ¨é…ç½®æ–¹å¼</li>
<li>äº†è§£å…³äºwebjarsçŸ¥è¯†</li>
</ol>
<p style="color: red;">æºç ä¸­å®šä¹‰èµ„æºè·¯å¾„çš„é™æ€æ•°ç»„ï¼š</p>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> CLASSPATH_RESOURCE_LOCATIONS <span class="token operator">=</span> 
    <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"classpath:/META-INF/resources/"</span><span class="token punctuation">,</span> <span class="token string">"classpath:/resources/"</span><span class="token punctuation">,</span> <span class="token string">"classpath:/static/"</span><span class="token punctuation">,</span> <span class="token string">"classpath:/public/"</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>åœ¨<code>application.yml</code>é…ç½®è·¯å¾„åŠè®¿é—®å‰ç¼€</p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token comment">#è‡ªå®šä¹‰é™æ€èµ„æºè®¿é—®å‰ç¼€ï¼Œä»¥åŠé™æ€èµ„æºç›®å½•</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span> 
  <span class="token key atrule">mvc</span><span class="token punctuation">:</span>
    <span class="token key atrule">static-path-pattern</span><span class="token punctuation">:</span> /diy/<span class="token important">**</span>

  <span class="token key atrule">web</span><span class="token punctuation">:</span>
    <span class="token key atrule">resources</span><span class="token punctuation">:</span>
      <span class="token key atrule">static-locations</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>classpath<span class="token punctuation">:</span>/diy/<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p style="color: red;">é™æ€èµ„æºå­˜æ”¾ä½ç½®ï¼š</p>

<img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210510123142.png">

<p>åœ¨webå¼€å‘ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿èµ„æºçš„ç»Ÿä¸€ç®¡ç†ï¼Œæˆ‘ä»¬å°†å‰ç«¯çš„èµ„æºæ–‡ä»¶(css,js)ç­‰æ–‡ä»¶<strong>ä»¥jaråŒ…çš„å½¢å¼å¯¼å…¥åˆ°mavené¡¹ç›®ä¸­ï¼šWebJars: web libraries in jars</strong></p>
<p>webjarçš„èµ„æºä½ç½®ï¼š<a target="_blank" rel="noopener" href="https://www.webjars.org/">WebJars - Web Libraries in Jars</a></p>
<hr>
<p><strong>å…³äºç³»ç»Ÿæ¬¢è¿é¡µé¢ä»¥åŠç½‘ç«™çš„å›¾æ ‡èµ„æºçš„è‡ªåŠ¨é…ç½®</strong></p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨å®˜æ–¹æŒ‡å®šçš„é»˜è®¤è·¯å¾„ä¸‹å­˜æ”¾ç›¸åº”çš„<code>index.html</code>å’Œ<code>favicon.ico</code>å®ƒä»¬å°±ä¼šè‡ªåŠ¨è¢«é…ç½®ä¸ºå¯¹åº”çš„æ¬¢è¿é¡µé¢å’Œå›¾æ ‡ã€‚å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨<strong>æ§åˆ¶å™¨ï¼‹è§†å›¾</strong>çš„æ–¹å¼ã€‚æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªä¸»é¡µæ¬¢è¿é¡µé¢çš„æ§åˆ¶å™¨ï¼Œå¹¶ä¸”ç¼–å†™ç›¸å¯¹äºçš„<code>index.ftl</code>æ¨¡æ¿ã€‚é‚£ä¹ˆåœ¨è®¿é—®ä¸»é¡µæ—¶ï¼Œspring bootè‡ªåŠ¨ä¼šè§£æç›¸å…³è”çš„é¡µé¢ï¼</p>
<hr>
<p><b style="font-size:24px">resté£æ ¼çš„è¯·æ±‚å¤„ç†ï¼šï¼ˆé€‚ç”¨äºè¡¨å•ï¼‰</b></p>
<p>åœ¨å¤„ç†httpè¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬ä¼šç¼–å†™ä¸€ç³»åˆ—çš„æ§åˆ¶å™¨æ¥æ‹¦æˆªå¤„ç†è¯·æ±‚ã€‚æ­¤æ—¶å°±éœ€è¦ä½¿ç”¨ä¸‹é¢çš„æ³¨è§£ï¼š</p>
<ul>
<li>@RequestMapping(value = â€œè¯·æ±‚è·¯å¾„â€, method = â€œè¯·æ±‚æ–¹å¼â€)</li>
<li>@xxxMapping(â€œè¯·æ±‚è·¯å¾„â€) eg: @GetMapping(â€œ/testâ€)</li>
</ul>
<p>resté£æ ¼ä¸‹ï¼Œæˆ‘ä»¬å°†ä»¥æ•°æ®èµ„æºä¸ºæ ¸å¿ƒï¼ˆurlï¼‰ï¼Œæ¯”å¦‚æˆ‘ä»¬è¯·æ±‚çš„è·¯å¾„ç»Ÿä¸€ä¸º **â€/testâ€**ï¼Œå¹¶ä¸”æ”¯æŒ getã€putã€deleteã€postã€‚ <strong>è¿™æ ·å°±å¯ä»¥ä¸“æ³¨äºè¯·æ±‚æ–¹å¼ï¼Œç»Ÿä¸€äº†è¯·æ±‚è·¯å¾„ï¼</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/user"</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"delete"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token annotation punctuation">@DeleteMapping</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬åœ¨htmlé¡µé¢æˆ–è€…æ˜¯æ¨¡æ¿å¼•æ“ä¸­å®šä¹‰è¡¨å•æ—¶ï¼Œå› ä¸ºè¡¨å•é»˜è®¤è‡³æ”¯æŒä¸¤ç§è¯·æ±‚æ–¹å¼ï¼šgetã€putã€‚æ‰€ä»¥æˆ‘ä»¬è‹¥æ˜¯æƒ³ä»è¡¨å•å‘å‡ºå…¶ä»–çš„è¯·æ±‚ï¼šdeleteã€postå°±éœ€è¦è¿™ä¹ˆåšï¼š</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>put<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>_method<span class="token punctuation">"</span></span> <span class="token attr-name">value</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>delete<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>æ­¤æ—¶è¡¨å•å¯ä»¥å‘å‡ºdeleteè¯·æ±‚ï¼å…³äºè¿™ä¹ˆåšçš„åº•å±‚åŸç†æš‚æ—¶ä¸åšæ·±å…¥äº†è§£ã€‚å…¶å®è¿™é‡Œè¿˜å¯ä»¥è‡ªå®šä¹‰inputä¸­çš„<code>name = "_diy"</code>ã€‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">HiddenHttpMethodFilter</span> <span class="token function">hiddenHttpMethodFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">HiddenHttpMethodFilter</span> methodFilter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HiddenHttpMethodFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    methodFilter<span class="token punctuation">.</span><span class="token function">setMethodParam</span><span class="token punctuation">(</span><span class="token string">"_diy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> methodFilter<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ç„¶äº†æœ€æœ€æœ€é‡è¦çš„å°±æ˜¯ï¼šè¡¨å•çš„reståŠŸèƒ½é»˜è®¤æ˜¯ä¸å¼€å¯çš„ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨é…ç½®å¼€å¯è¿™é¡¹åŠŸèƒ½ï¼</p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token comment">#å¼€å¯é¡µé¢è¡¨å•çš„ReståŠŸèƒ½</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">mvc</span><span class="token punctuation">:</span>
    <span class="token key atrule">hiddenmethod</span><span class="token punctuation">:</span>
      <span class="token key atrule">filter</span><span class="token punctuation">:</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åˆ°æ­¤éƒ½æ˜¯é’ˆå¯¹è¡¨å•çš„httpè¯·æ±‚ï¼ˆå› ä¸ºè¡¨å•é»˜è®¤åªå­˜åœ¨ä¸¤ç§è¯·æ±‚æ–¹å¼ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬åšäº›å˜åŒ–ï¼‰ï¼Œ<strong>å¯¹äºä¸€äº›å¯ä»¥ç›´æ¥å‘é€ç›¸åº”è¯·æ±‚çš„å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦é…ç½®filter</strong></p>
<hr>
<p><b style="font-size:24px">è¯·æ±‚å¤„ç†æ³¨è§£çš„ä½¿ç”¨</b></p>
<p><code>@PathVariable</code>ï¼šæ­¤æ³¨è§£å¯ä»¥å¸®åŠ©æˆ‘ä»¬ä»urlè·å–å˜é‡çš„å€¼ã€‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/car/{id}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Car</span> <span class="token function">getCarById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> 
        <span class="token keyword">return</span> car<span class="token punctuation">;</span>
    <span class="token keyword">else</span> 
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>@RequestHeader</code>ï¼šç”¨äºè·å–httpè¯·æ±‚å¤´çš„å†…å®¹</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printHeader</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestHeader</span><span class="token punctuation">(</span><span class="token string">"User-Agent"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> userAgent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userAgent<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>@RequestParam</code>ï¼šå°†httpè¯·æ±‚å‚æ•°ç»‘å®šåˆ°æ§åˆ¶å™¨æ–¹æ³•ä¸Š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printParams</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“æˆ‘ä»¬ä»¥<a target="_blank" rel="noopener" href="https://localhost8080/user?name=matemaster&amp;age=23%E7%9A%84url%E8%AE%BF%E9%97%AE%E6%97%B6%EF%BC%8C%E5%90%8E%E5%8F%B0%E4%BC%9A%E8%87%AA%E5%8A%A8%E6%89%93%E5%8D%B0param%E7%BB%91%E5%AE%9A%E7%9A%84%E5%8F%82%E6%95%B0%EF%BC%9A%60%7Bname=matemaster">https://localhost8080/user?name=matemaster&amp;age=23çš„urlè®¿é—®æ—¶ï¼Œåå°ä¼šè‡ªåŠ¨æ‰“å°paramç»‘å®šçš„å‚æ•°ï¼š`{name=matemaster</a>, age=23}`</p>
<p><code>@CookieValue</code>ï¼šè·å–æµè§ˆå™¨çš„cookieä¿¡æ¯</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/cookie"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printCookieInfo</span><span class="token punctuation">(</span><span class="token annotation punctuation">@CookieValue</span><span class="token punctuation">(</span><span class="token string">"Idea-27e61da4"</span><span class="token punctuation">)</span> <span class="token class-name">Cookie</span> cookie<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"cookieåç§°ï¼š"</span><span class="token operator">+</span>cookie<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"cookieå€¼ï¼š"</span><span class="token operator">+</span>cookie<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>@RequestBody</code>ï¼šè·å–httpè¯·æ±‚ä½“</p>
<p><code>@MatrixVariable</code>ï¼šè·å–urlä¸­çš„çŸ©é˜µå˜é‡</p>
<p>çŸ©é˜µå˜é‡ï¼šlocalhost:8080/matrix/user;name=matemaster;age=23.è¿™é‡Œçš„nameå’Œageå°±æ˜¯çŸ©é˜µå˜é‡</p>
<p><strong>ä½†æ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼ŒçŸ©é˜µå˜é‡æ˜¯è¢«ç¦ç”¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡ä¿®<code>WebMvcConfigurer</code>æ¥å£ä¸­çš„configurePathMatchæ–¹æ³•ï¼Œä»¥å¯ç”¨çŸ©é˜µå˜é‡</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configurePathMatch</span><span class="token punctuation">(</span><span class="token class-name">PathMatchConfigurer</span> configurer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UrlPathHelper</span> helper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UrlPathHelper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        helper<span class="token punctuation">.</span><span class="token function">setRemoveSemicolonContent</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        configurer<span class="token punctuation">.</span><span class="token function">setUrlPathHelper</span><span class="token punctuation">(</span>helper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨æ§åˆ¶å™¨æ–¹æ³•ä¸­ï¼Œä½¿ç”¨çŸ©é˜µå˜é‡æ³¨è§£ã€‚å› ä¸ºçŸ©é˜µå˜é‡çš„ä½¿ç”¨ä¾æ‰˜äºè·¯å¾„å˜é‡ï¼Œæ‰€ä»¥è¿™é‡ŒåŠ å…¥äº†pathè·¯å¾„å˜é‡</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/matrix/{path}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printMatrix</span><span class="token punctuation">(</span><span class="token annotation punctuation">@MatrixVariable</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span>
                        <span class="token annotation punctuation">@MatrixVariable</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span> <span class="token keyword">int</span> age<span class="token punctuation">,</span>
                        <span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">,</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è·¯å¾„å˜é‡çš„åŠ å…¥å¦å¤–ä¸€ä¸ªä½œç”¨å°±æ˜¯ç”¨äºè§£å†³<strong>æ­§ä¹‰é—®é¢˜</strong>ã€‚å‡è®¾ç°åœ¨urlè¯·æ±‚è·¯å¾„å­˜åœ¨è¿™æ ·çš„æƒ…å†µ<code>localhost:8080/matrix/usr;name=matemaster;age=23/car;brand=Ferrari;age=112</code>ã€‚å› ä¸ºageå­˜åœ¨ä¸åŒçš„ç±»ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç›´æ¥ä½¿ç”¨çŸ©é˜µå˜é‡æŒ‡å®šå–ageæ—¶ï¼Œå°±ä¼šæ­§ä¹‰ã€‚<strong>æ‰€ä»¥è¿™é‡Œå¯ä»¥æŒ‡å®šæ˜¯é‚£ä¸ªè·¯å¾„å˜é‡ä¸‹çš„ageçŸ©é˜µå˜é‡</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/matrix/{usr}/{car}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token annotation punctuation">@MatrixVariable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"age"</span><span class="token punctuation">,</span>pathVar <span class="token operator">=</span> <span class="token string">"usr"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> usrAge<span class="token punctuation">,</span>
                  <span class="token annotation punctuation">@MatrixVariable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"age"</span><span class="token punctuation">,</span>pathVar <span class="token operator">=</span> <span class="token string">"car"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> carAge<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>usrAge<span class="token operator">+</span>carAge<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<p><b style="font-size:24px">å¸¸ç”¨åŠŸèƒ½</b></p>
<p><b style="font-size:20px">1. è·¯å¾„åŒ¹é…å’Œå†…å®¹åå•†</b></p>
<p>è·¯å¾„åŒ¹é…ï¼šspring bootæ ¹æ®httpè¯·æ±‚é“¾æ¥æ¥å°†ä»–åŒ¹é…ç»™ç›¸å¯¹åº”çš„<code>@xxxMapping</code>æ³¨è§£æ˜ å°„çš„<code>Controller</code>æ–¹æ³•ï¼Œæ¥æ­£ç¡®å¤„ç†è¯·æ±‚ã€‚</p>
<p>å†…å®¹åå•†ï¼šä¸€ä»½ç‰¹å®šçš„æ–‡ä»¶ç§°ä¸ºä¸€é¡¹èµ„æºã€‚å½“å®¢æˆ·ç«¯è·å–èµ„æºçš„æ—¶å€™ï¼Œä¼šä½¿ç”¨å…¶å¯¹åº”çš„ URL å‘é€è¯·æ±‚ã€‚æœåŠ¡å™¨é€šè¿‡è¿™ä¸ª URL æ¥é€‰æ‹©å®ƒæŒ‡å‘çš„èµ„æºçš„æŸä¸€å˜ä½“â€”â€”æ¯ä¸€ä¸ªå˜ä½“ç§°ä¸ºä¸€ç§å±•ç°å½¢å¼â€”â€”ç„¶åå°†è¿™ä¸ªé€‰å®šçš„å±•ç°å½¢å¼è¿”å›ç»™å®¢æˆ·ç«¯ã€‚æ•´ä¸ªèµ„æºï¼Œè¿åŒå®ƒçš„å„ç§å±•ç°å½¢å¼ï¼Œå…±äº«ä¸€ä¸ªç‰¹å®šçš„ URL ã€‚å½“ä¸€é¡¹èµ„æºè¢«è®¿é—®çš„æ—¶å€™ï¼Œç‰¹å®šå±•ç°å½¢å¼çš„é€‰å–æ˜¯é€šè¿‡å†…å®¹åå•†æœºåˆ¶æ¥å†³å®šçš„ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¹‹é—´å­˜åœ¨å¤šç§åå•†æ–¹å¼ã€‚</p>
<p>å› ä¸º spring boot é»˜è®¤ç¦ç”¨äº† â€åç¼€åŒ¹é…â€œ é‡‡å– â€å†…å®¹åå•†â€œ çš„æ–¹å¼ï¼Œæ‰€ä»¥ç±»ä¼¼è¿™æ ·çš„è¯·æ±‚<code>"GET /projects/spring-boot.json"</code>ï¼Œå°±ä¸ä¼šè¢«æ˜ å°„åˆ° <code>@GetMapping("/projects/spring-boot")</code>æ˜ å°„çš„æ§åˆ¶å™¨æ–¹æ³•ä¸Šã€‚</p>
<p>è™½ç„¶ç¦ç”¨äº† åç¼€åŒ¹é… ï¼Œä½†æ˜¯å¯¹äº â€ä¸èƒ½å‘é€Acceptçš„æµè§ˆå™¨â€œ ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å– <strong>â€å‚æ•°æŸ¥è¯¢â€œ</strong> çš„æ–¹å¼è§£å†³ã€‚æ¯”å¦‚è¿™æ ·çš„é“¾æ¥ï¼š <code>"GET /projects/spring-boot?format=json"</code>å°±å¯ä»¥è¢«æ˜ å°„åˆ° <code>@GetMapping("/projects/spring-boot")</code>æ˜ å°„çš„æ§åˆ¶å™¨æ–¹æ³•</p>
<p>ä¸ºäº†èƒ½è®© spring boot å¼€å¯ä¸Šé¢çš„å‚æ•°æŸ¥è¯¢åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œé…ç½®</p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">mvc</span><span class="token punctuation">:</span>
    <span class="token key atrule">contentnegotiation</span><span class="token punctuation">:</span>
      <span class="token key atrule">favor-parameter</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>      <span class="token comment"># å¼€å¯ query parameter åŠŸèƒ½</span>
      <span class="token key atrule">parameter-name</span><span class="token punctuation">:</span> myparam    <span class="token comment"># å®šä¹‰å‚æ•°æŸ¥è¯¢çš„åç§°ï¼ˆæ¯”å¦‚ä¸Šé¢çš„format = json---&gt; myparam = jsonï¼‰</span>
      <span class="token key atrule">media-types</span><span class="token punctuation">:</span> text/markdown <span class="token comment"># é¢å¤–å¢åŠ è¿”å›èµ„æºçš„æ ¼å¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<p><b style="font-size:27px">Spring HATEOAS</b></p>
<p><code>hypermedia as the engine of application state</code>ï¼šå‡è½»å®¢æˆ·ç«¯ç¡¬ç¼–ç è¯·æ±‚çš„ç—›è‹¦ã€‚</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-hateoas<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨ä¹‹å‰spring5å®æˆ˜å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°ä¸€ç§ä¸ºæ•´ä¸ªtacoåˆ—è¡¨æ·»åŠ è¶…é“¾æ¥çš„ä¸€ç§æ–¹æ³•ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/recent"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Resources</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">&lt;</span><span class="token class-name">Taco</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">recentTacos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">PageRequest</span> page <span class="token operator">=</span> <span class="token class-name">PageRequest</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token class-name">Sort</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span><span class="token string">"createdAt"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">descending</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Taco</span><span class="token punctuation">&gt;</span></span> tacos <span class="token operator">=</span> tacoRepo<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">/**å°†tacoåˆ—è¡¨æ‰“åŒ…æˆèµ„æºé›†åˆ*/</span>
    <span class="token class-name">Resources</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">&lt;</span><span class="token class-name">Taco</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> recentResources <span class="token operator">=</span> 
        <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span>tacos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">/**ä¸ºtacoèµ„æºé›†åˆæ·»åŠ è¶…é“¾æ¥*/</span>
    recentResources<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
        <span class="token keyword">new</span> <span class="token class-name">Link</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080/design/recent"</span><span class="token punctuation">,</span> <span class="token string">"recents"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> recentResources<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™é‡Œæ·»åŠ çš„è¶…é“¾æ¥ä¾æ—§æ˜¯ç¡¬ç¼–ç ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨spring hateoasä¸­çš„é“¾æ¥æ„é€ è€…ï¼š<strong>ControllerLinkBuilder</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">recentResources<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
    <span class="token class-name">ControllerLinkBuilder</span><span class="token punctuation">.</span><span class="token function">linkTo</span><span class="token punctuation">(</span><span class="token class-name">DesignTacoController</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    					 <span class="token punctuation">.</span><span class="token function">slash</span><span class="token punctuation">(</span><span class="token string">"recent"</span><span class="token punctuation">)</span>
    					 <span class="token punctuation">.</span><span class="token function">withRel</span><span class="token punctuation">(</span><span class="token string">"reccents"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ–è€…æ˜¯è¿™æ ·çš„æ¶ˆé™¤ç¡¬ç¼–ç æ–¹å¼ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">recentResources<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
    <span class="token class-name">ControllerLinkBuilder</span><span class="token punctuation">.</span><span class="token function">linkTo</span><span class="token punctuation">(</span><span class="token function">methodOn</span><span class="token punctuation">(</span><span class="token class-name">DesignTacoController</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">recentTacos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    					 <span class="token punctuation">.</span><span class="token function">withRel</span><span class="token punctuation">(</span><span class="token string">"recents"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç»¼ä¸Šæ‰€è¿°ï¼šæˆ‘ä»¬å°±è§£å†³äº†ä¸ºèµ„æºé›†åˆæ·»åŠ è¶…é“¾æ¥çš„é—®é¢˜ï¼Œä½†æ˜¯èµ„æºé›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ å¦‚ä½•æ·»åŠ è¶…é“¾æ¥ï¼Ÿ</strong></p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬ä¸åœ¨æ˜¯ä»¥<code>Resources.wrap(tacos)</code>çš„æ–¹å¼åˆ›å»ºèµ„æºé›†åˆã€‚</p>
<p>æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªæ—¢å¯ä»¥å­˜å‚¨tacoå¯¹è±¡æ•°æ®åˆå¯ä»¥æºå¸¦é“¾æ¥çš„èµ„æºç±»ï¼š<code>TacoResource</code></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TacoResource</span> <span class="token keyword">extends</span> <span class="token class-name">ResourceSupport</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Getter</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Getter</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Date</span> createdAt<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Getter</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Ingredient</span><span class="token punctuation">&gt;</span></span> ingredients<span class="token punctuation">;</span>
    
    
    <span class="token keyword">public</span> <span class="token class-name">TacoResource</span><span class="token punctuation">(</span><span class="token class-name">Taco</span> taco<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> taco<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>createdAt <span class="token operator">=</span> taco<span class="token punctuation">.</span><span class="token function">getCreatedAt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ingredients <span class="token operator">=</span> taco<span class="token punctuation">.</span><span class="token function">getIngredients</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½¢å¼ä¸Šæ¥çœ‹ï¼Œè¿™ä¸ª<code>TacoResource</code>ä¸<code>Taco</code>æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œä½†æ˜¯å› ä¸º<code>TacoResource</code>ç»§æ‰¿äº†<code>ResourceSupport</code>ç±»ï¼Œé‚£ä¹ˆä»–å°†è‡ªåŠ¨ä¼šæœ‰ä¸€ä¸ªLinkå¯¹è±¡åˆ—è¡¨å’Œç®¡ç†é“¾æ¥åˆ—è¡¨çš„æ–¹æ³•ã€‚</p>
<p>ä¸ºäº†é¦–å…ˆTaco-&gt;TacoResourceçš„è½¬æ¢ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªèµ„æºè£…é…å™¨ï¼Œå°†Tacoçš„èµ„æºè£…é…åˆ°TacoResourceã€‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TacoResourceAssembler</span> 
    <span class="token keyword">extends</span> <span class="token class-name">ResourceAssmblerSupport</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Taco</span><span class="token punctuation">,</span> <span class="token class-name">TacoResource</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">TacoResourceAssembler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token class-name">DesignTacoController</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">TacoResource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">TacoResource</span> <span class="token function">instantiateResource</span><span class="token punctuation">(</span><span class="token class-name">Taco</span> taco<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TacoResource</span><span class="token punctuation">(</span>taco<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">TacoResource</span> <span class="token function">toResource</span><span class="token punctuation">(</span><span class="token class-name">Taco</span> taco<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">createdResourceWithId</span><span class="token punctuation">(</span>taco<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> taco<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>toResource(Taco)</code>å¼ºåˆ¶é‡å†™ï¼Œå¯¹äº<code>instantiateResource(Taco)</code>æ–¹æ³•æ˜¯å¯é€‰çš„ã€‚å¦‚æœåœ¨TacoResourceæœ‰é»˜è®¤æ„é€ å™¨æ—¶ã€‚</p>
<p><strong>ç»è¿‡ä¸Šé¢çš„åŠªåŠ›ï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥å¾—åˆ°ç±»ä¼¼ä¸‹é¢çš„jsonæ–‡ä»¶</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"_embedded"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"tacoResourceList"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Veg-out"</span><span class="token punctuation">,</span>
            <span class="token property">"createdAt"</span><span class="token operator">:</span> <span class="token string">"2018-01-31T20:15:53.219+0000"</span><span class="token punctuation">,</span>
            <span class="token property">"ingredient"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Flour Tortilla"</span><span class="token punctuation">,</span>
                    <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"WRAP"</span><span class="token punctuation">,</span>
                    <span class="token property">"_links"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token property">"self"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"href"</span><span class="token operator">:</span> <span class="token string">"http://localhost:8080/ingredients/FLOTO"</span><span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token property">"_links"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"recents"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"href"</span><span class="token operator">:</span> <span class="token string">"http://localhost:8080/design/recent"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŸå§‹çš„tacoResourceListåç§°å…¶å®æ˜¯æ¥è‡ªäºæˆ‘ä»¬ç¬¬ä¸€æ¬¡å°è¯•åˆ›å»ºèµ„æºé›†åˆæ—¶ï¼ŒList&lt;TacoResource&gt;åˆ›å»ºå‡ºæ¥çš„ï¼Œä½†æ˜¯å‡è®¾æˆ‘ä»¬çš„TacoResourceåç§°ï¼Œæ”¹å˜äº†ï¼Œé‚£ä¹ˆæ‰€æœ‰ä¸ä¹‹ç›¸å…³çš„jsonå­—æ®µéƒ½ä¼šå‡ºé—®é¢˜ï¼Œæ‰€ä»¥ä¸ºäº†è§£è€¦ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>@Relation</code>æ³¨è§£</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Relation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"taco"</span><span class="token punctuation">,</span> collection <span class="token operator">=</span> <span class="token string">"tacos"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TacoResource</span> <span class="token keyword">extends</span> <span class="token class-name">ResourceSupport</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è¿™æ ·å¾—åˆ°çš„json</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"_embedded"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"tacos"</span><span class="token operator">:</span> <span class="token punctuation">[</span>...<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<p><b style="font-size:25px">ä½¿ç”¨Spring Data Restå®šä¹‰åº”ç”¨çš„API</b></p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-rest<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å› ä¸ºæœ‰æ—¶å€™è‡ªå·±ç¼–å†™æ§åˆ¶å™¨çš„ç«¯ç‚¹å¯èƒ½ä¼šä¸Spring Data RESTåˆ›å»ºçš„ç«¯ç‚¹å†²çªï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é…ç½®ä¸­è®¾ç½®restçš„ç«¯ç‚¹è·¯å¾„</p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">data</span><span class="token punctuation">:</span>
    <span class="token key atrule">rest</span><span class="token punctuation">:</span>
      <span class="token key atrule">base-path</span><span class="token punctuation">:</span> /api<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>curl http://localhost:8080/api</code> æŸ¥çœ‹ Spring Data REST è‡ªåŠ¨åˆ›å»ºçš„ç«¯ç‚¹ï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"_links"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"orders"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">"href"</span><span class="token operator">:</span> <span class="token string">"http://localhost:8080/api/orders"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"ingredients"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">"href"</span><span class="token operator">:</span> <span class="token string">"http://localhost:8080/api/ingredients"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"tacoes"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">"href"</span><span class="token operator">:</span> <span class="token string">"http://localhost:8080/api/tacoes{?page,size,sort}"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"users"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">"href"</span><span class="token operator">:</span> <span class="token string">"http://localhost:8080/api/users"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"profile"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">"href"</span><span class="token operator">:</span> <span class="token string">"http://localhost:8080/api/profile"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬ä»è‡ªåŠ¨åˆ›å»ºçš„ç«¯ç‚¹é“¾æ¥æ¥çœ‹ï¼ŒSprig Data Repository åœ¨åˆ›å»ºç«¯ç‚¹çš„æ—¶å€™æ˜¯æ ¹æ®å®ä½“ç±»çš„å¤æ•°å½¢å¼å‘½åé“¾æ¥çš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€ä¸ªå¼€æ§åˆ¶å™¨åœ¨è‡ªå®šä¹‰ç«¯ç‚¹æ—¶ï¼Œæƒ³è®©tacoä½¿ç”¨tacosï¼Œä½†æ˜¯ç”±äºå¤æ•°å½¢å¼tacoesä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œæˆ‘æƒ³è‡ªå·±è¯¥å‘½åï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨å¯¹åº”çš„å®ä½“ç±»ä¸Šä½¿ç”¨<code>@RestResource</code></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ResrResource</span><span class="token punctuation">(</span>rel <span class="token operator">=</span> <span class="token string">"tacos"</span><span class="token punctuation">,</span> path <span class="token operator">=</span> <span class="token string">"tacos"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Taoc</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è¿™æ · Sprig Data Repository åœ¨åˆ›å»ºç«¯ç‚¹çš„æ—¶å€™ï¼Œé“¾æ¥å°±ä¼šæ˜¯è¿™æ ·</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"tacos"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"href"</span><span class="token operator">:</span> <span class="token string">"http://localhost:8080/api/tacos{?page,size,sort}"</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœéœ€è¦å®šä¹‰è‡ªå·±çš„ç«¯ç‚¹ï¼Œå¹¶ä¸”è‡ªå®šä¹‰çš„ç«¯ç‚¹å¯ä»¥åœ¨æ‹¥æœ‰ Sprig Data Repository åˆ›å»ºç«¯ç‚¹çš„ç›¸åŒå‰ç¼€ï¼Œæ¯”å¦‚ï¼šapiã€‚é‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>@RepositoryRestController</code>è¿™æ ·å®šä¹‰çš„æ§åˆ¶å™¨ï¼Œè®¿é—®è¯·æ±‚è·¯å¾„ä¸ä¸Šé¢è‡ªåŠ¨å®šä¹‰çš„ç«¯ç‚¹å­˜åœ¨ç›¸åŒçš„å‰ç¼€ã€‚</p>
<p><b style="color: red">ä¸Šé¢çš„å™è¿°éƒ½æ˜¯ä¸ºäº†åˆ›å»ºrestçš„apiï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±ä»‹ç»å¦‚ä½•æ¶ˆè´¹è¿™äº›api</b></p>
<hr>
<p>springåº”ç”¨å­˜åœ¨å¤šç§æ¶ˆè´¹apiçš„æ–¹å¼ï¼š</p>
<ul>
<li>RestTempalte</li>
<li>Traverson</li>
<li>Webclient</li>
</ul>
<p><b style="color:blue">å­¦ä¹ RestTemplateå¦‚ä½•æ¶ˆè´¹è¿™äº›api</b></p>
<ol>
<li>åœ¨éœ€è¦çš„åœ°æ–¹ç›´æ¥åˆ›å»ºå®ä¾‹</li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">RestTempalte</span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li>å¯ä»¥ä»¥beançš„å½¢å¼æ³¨å…¥åˆ°éœ€è¦ä½¿ç”¨çš„åœ°æ–¹</li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">restTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ‰äº†è¿™ä¸ªæ¨¡æ¿å®ä¾‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ¨¡æ¿çš„æ“ä½œæ¥æ¶ˆè´¹restçš„apiã€‚ä¸»è¦ä»¥ï¼ˆPUTã€GETã€DELETEã€POSTï¼‰</p>
<p>æˆ‘ä»¬é¦–å…ˆå°è¯•ä»restçš„apiè·å–èµ„æºï¼ˆGET èµ„æºï¼‰</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Ingredient</span> <span class="token function">getIngredientById</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> template<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080/ingredients/{id}"</span><span class="token punctuation">,</span>
                                <span class="token class-name">Ingredient</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œåˆ©ç”¨çš„æ˜¯æ¨¡æ¿çš„<code>getForObject</code>æ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥åˆ©ç”¨apiå–è·å–å¯¹åº”çš„å¯¹è±¡</p>
<p>å½“ç„¶ç±»ä¼¼äº<code>getForObject</code>å­˜åœ¨å¤šç§é‡è½½å½¢å¼ï¼š</p>
<p>ä½¿ç”¨Stringä½œä¸ºURLæ ¼å¼ï¼Œä½¿ç”¨MapæŒ‡æ˜å‚æ•°</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Ingredient</span> <span class="token function">getIngredientById</span><span class="token punctuation">(</span>string id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> hashMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> template<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080/ingredients/{id}"</span><span class="token punctuation">,</span>
                                <span class="token class-name">Ingredient</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>hashMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½¿ç”¨java.net.URIä½œä¸ºURLæ ¼å¼ï¼Œä¸æ”¯æŒå‚æ•°åŒ–çš„URL</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Ingredient</span> <span class="token function">getIngredientById</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> hashMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">URI</span> url <span class="token operator">=</span> <span class="token class-name">UriComponentBuilder</span>
        		<span class="token punctuation">.</span><span class="token function">fromHttpUrl</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080/ingredients/{id}"</span><span class="token punctuation">)</span>
        		<span class="token punctuation">.</span><span class="token function">bulid</span><span class="token punctuation">(</span>hashmap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> template<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token class-name">Ingredient</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>äº†è§£äº†<code>getForObject</code>å¤šç§é‡è½½å½¢å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>getForEntity</code>è·å–å“åº”å®ä½“ã€‚ä»–æœ‰ç€ç±»ä¼¼çš„å‚æ•°é‡è½½æ–¹å¼</p>
<p>æ¥ä¸‹æ¥å°è¯•å¦‚ä½•æ‰¹é‡ï¼ˆPUT èµ„æºï¼‰</p>
<p>ä¸ºäº†HTTPçš„PUTè¯·æ±‚ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ¨¡æ¿çš„putæ–¹æ³•ï¼Œä»–æœ‰ç€ç±»ä¼¼çš„é‡è½½æ–¹å¼</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Ingredient</span> ing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    template<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080/ingredients/{id}"</span><span class="token punctuation">,</span>
                ing<span class="token punctuation">,</span>
                ing<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¥ç€å°è¯•ï¼ˆDELETE èµ„æºï¼‰</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">del</span><span class="token punctuation">(</span><span class="token class-name">Ingredient</span> ing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    template<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080/ingredients/{id}"</span><span class="token punctuation">,</span> ing<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>æ¥ç€å°è¯•ï¼ˆPOST èµ„æºï¼‰</p>
<p>postå­˜åœ¨ä¸‰ç§æ–¹å¼ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token function">postForObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">postForEntoty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">postForLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><b style="color:blue">å­¦ä¹ Traversonå¯¼èˆªrest api</b></p>
<p>éå†APIçš„å…³ç³»åæ¥æ¶ˆè´¹api</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Traverson</span> <span class="token keyword">to</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Traverson</span><span class="token punctuation">(</span>
    URI<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080/api"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">MediaTypes</span><span class="token punctuation">.</span>HAL_JSON
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¯ä»¥ä»¥beançš„å½¢å¼æ³¨å…¥åˆ°éœ€è¦ä½¿ç”¨çš„åœ°æ–¹</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">Traverson</span> <span class="token function">traversOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Traverson</span><span class="token punctuation">(</span>URI<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080/api"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">MediaTypes</span><span class="token punctuation">.</span>HAL_JSON<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ‰äº† <code>Traverson</code> å®ä¾‹æˆ‘ä»¬å°±å¯ä»¥å°†å®¢æˆ·ç«¯å¯¼èˆªåˆ°å¯¹åº”çš„é“¾æ¥å…³ç³»åä¸‹ã€‚</p>
<hr>
<h3 id="Webçš„å°demo"><a href="#Webçš„å°demo" class="headerlink" title="Webçš„å°demo"></a>Webçš„å°demo</h3><hr>
<p>è¿™é‡Œç®€å•çš„åšä¸€ä¸ªspring bootçš„webmvcçš„demo ğŸ‘‰<a target="_blank" rel="noopener" href="https://gitee.com/matemaster/master-depository/tree/master/spring/demoweb">å®Œæ•´çš„demoä»£ç </a></p>
<p>å…³äºå¦‚ä½•åˆå§‹åŒ–springbootæ­å»ºå°±ä¸å†èµ˜è¿°ã€æˆ‘ä»¬å…ˆä»æ•°æ®åº“çš„æ­å»ºå’Œè¿æ¥åšèµ·</p>
<ol>
<li>æ­å»ºwebç›¸å…³çš„spring bootåº”ç”¨åœºæ™¯</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210518235401.png"></p>
<ol start="2">
<li>åœ¨spring bootä¸­é…ç½®æ•°æ®æºçš„ç›¸å…³ä¿¡æ¯</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210518235537.png"></p>
<ol start="3">
<li>åœ¨ä¸Šé¢é…ç½®çš„sqlä½ç½®ï¼Œç¼–å†™æ•°æ®åº“ç›¸å…³çš„sqlè„šæœ¬</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210518235723.png"></p>
<ol start="4">
<li>ä¸šåŠ¡é€»è¾‘ä»£ç çš„è®¾è®¡</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210519082129.png"></p>
<p>å…³äºé¢†åŸŸå¯¹è±¡ï¼šUsrå’ŒResult</p>
<p>Resultå°†ä¼šå­˜å‚¨sqlè¯­å¥æ‰§è¡Œçš„ç»“æœï¼ŒUsrå°±æ˜¯å…·ä½“çš„ä¿¡æ¯å­˜å‚¨å¯¹è±¡</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"tb_usr"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Usr</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"password"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Result</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">HttpStatus</span> code<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Usr</span> usr<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬åˆ©ç”¨JPAæŠ€æœ¯è‡ªåŠ¨ç”Ÿæˆç®€å•ä¸šåŠ¡é€»è¾‘å®ç°çš„å¥½å¤„ï¼Œæ ¹æ®IDæŸ¥æ‰¾å¯¹åº”çš„Usrå¯¹è±¡</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UsrRepository</span> <span class="token keyword">extends</span> <span class="token class-name">CrudRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Usr</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ol start="5">
<li>åˆ©ç”¨restæ¶ˆè´¹ä¸Šé¢è®¾è®¡çš„apiç«¯å£</li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> template<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">public</span> <span class="token class-name">RestTest</span><span class="token punctuation">(</span><span class="token class-name">RestTemplateBuilder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>template <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/usr"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Result</span> <span class="token function">getUsr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Usr</span> usr <span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080/{id}"</span><span class="token punctuation">,</span> <span class="token class-name">Usr</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Result</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>usr <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result<span class="token punctuation">.</span><span class="token function">setUsr</span><span class="token punctuation">(</span>usr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        result<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="Spring-Data"><a href="#Spring-Data" class="headerlink" title="Spring Data"></a>Spring Data</h2><table>
<thead>
<tr>
<th align="left">Keyword</th>
<th align="left">Sample</th>
<th align="left">JPQL snippet</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>Distinct</code></td>
<td align="left"><code>findDistinctByLastnameAndFirstname</code></td>
<td align="left"><code>select distinct â€¦ where x.lastname = ?1 and x.firstname = ?2</code></td>
</tr>
<tr>
<td align="left"><code>And</code></td>
<td align="left"><code>findByLastnameAndFirstname</code></td>
<td align="left"><code>â€¦ where x.lastname = ?1 and x.firstname = ?2</code></td>
</tr>
<tr>
<td align="left"><code>Or</code></td>
<td align="left"><code>findByLastnameOrFirstname</code></td>
<td align="left"><code>â€¦ where x.lastname = ?1 or x.firstname = ?2</code></td>
</tr>
<tr>
<td align="left"><code>Is</code>, <code>Equals</code></td>
<td align="left"><code>findByFirstname</code>,<code>findByFirstnameIs</code>,<code>findByFirstnameEquals</code></td>
<td align="left"><code>â€¦ where x.firstname = ?1</code></td>
</tr>
<tr>
<td align="left"><code>Between</code></td>
<td align="left"><code>findByStartDateBetween</code></td>
<td align="left"><code>â€¦ where x.startDate between ?1 and ?2</code></td>
</tr>
<tr>
<td align="left"><code>LessThan</code></td>
<td align="left"><code>findByAgeLessThan</code></td>
<td align="left"><code>â€¦ where x.age &lt; ?1</code></td>
</tr>
<tr>
<td align="left"><code>LessThanEqual</code></td>
<td align="left"><code>findByAgeLessThanEqual</code></td>
<td align="left"><code>â€¦ where x.age &lt;= ?1</code></td>
</tr>
<tr>
<td align="left"><code>GreaterThan</code></td>
<td align="left"><code>findByAgeGreaterThan</code></td>
<td align="left"><code>â€¦ where x.age &gt; ?1</code></td>
</tr>
<tr>
<td align="left"><code>GreaterThanEqual</code></td>
<td align="left"><code>findByAgeGreaterThanEqual</code></td>
<td align="left"><code>â€¦ where x.age &gt;= ?1</code></td>
</tr>
<tr>
<td align="left"><code>After</code></td>
<td align="left"><code>findByStartDateAfter</code></td>
<td align="left"><code>â€¦ where x.startDate &gt; ?1</code></td>
</tr>
<tr>
<td align="left"><code>Before</code></td>
<td align="left"><code>findByStartDateBefore</code></td>
<td align="left"><code>â€¦ where x.startDate &lt; ?1</code></td>
</tr>
<tr>
<td align="left"><code>IsNull</code>, <code>Null</code></td>
<td align="left"><code>findByAge(Is)Null</code></td>
<td align="left"><code>â€¦ where x.age is null</code></td>
</tr>
<tr>
<td align="left"><code>IsNotNull</code>, <code>NotNull</code></td>
<td align="left"><code>findByAge(Is)NotNull</code></td>
<td align="left"><code>â€¦ where x.age not null</code></td>
</tr>
<tr>
<td align="left"><code>Like</code></td>
<td align="left"><code>findByFirstnameLike</code></td>
<td align="left"><code>â€¦ where x.firstname like ?1</code></td>
</tr>
<tr>
<td align="left"><code>NotLike</code></td>
<td align="left"><code>findByFirstnameNotLike</code></td>
<td align="left"><code>â€¦ where x.firstname not like ?1</code></td>
</tr>
<tr>
<td align="left"><code>StartingWith</code></td>
<td align="left"><code>findByFirstnameStartingWith</code></td>
<td align="left"><code>â€¦ where x.firstname like ?1</code> (parameter bound with appended <code>%</code>)</td>
</tr>
<tr>
<td align="left"><code>EndingWith</code></td>
<td align="left"><code>findByFirstnameEndingWith</code></td>
<td align="left"><code>â€¦ where x.firstname like ?1</code> (parameter bound with prepended <code>%</code>)</td>
</tr>
<tr>
<td align="left"><code>Containing</code></td>
<td align="left"><code>findByFirstnameContaining</code></td>
<td align="left"><code>â€¦ where x.firstname like ?1</code> (parameter bound wrapped in <code>%</code>)</td>
</tr>
<tr>
<td align="left"><code>OrderBy</code></td>
<td align="left"><code>findByAgeOrderByLastnameDesc</code></td>
<td align="left"><code>â€¦ where x.age = ?1 order by x.lastname desc</code></td>
</tr>
<tr>
<td align="left"><code>Not</code></td>
<td align="left"><code>findByLastnameNot</code></td>
<td align="left"><code>â€¦ where x.lastname &lt;&gt; ?1</code></td>
</tr>
<tr>
<td align="left"><code>In</code></td>
<td align="left"><code>findByAgeIn(Collection&lt;Age&gt; ages)</code></td>
<td align="left"><code>â€¦ where x.age in ?1</code></td>
</tr>
<tr>
<td align="left"><code>NotIn</code></td>
<td align="left"><code>findByAgeNotIn(Collection&lt;Age&gt; ages)</code></td>
<td align="left"><code>â€¦ where x.age not in ?1</code></td>
</tr>
<tr>
<td align="left"><code>True</code></td>
<td align="left"><code>findByActiveTrue()</code></td>
<td align="left"><code>â€¦ where x.active = true</code></td>
</tr>
<tr>
<td align="left"><code>False</code></td>
<td align="left"><code>findByActiveFalse()</code></td>
<td align="left"><code>â€¦ where x.active = false</code></td>
</tr>
<tr>
<td align="left"><code>IgnoreCase</code></td>
<td align="left"><code>findByFirstnameIgnoreCase</code></td>
<td align="left"><code>â€¦ where UPPER(x.firstname) = UPPER(?1)</code></td>
</tr>
</tbody></table>
<p><b style="color:red">JPA</b></p>
<p>JPAçš„é¢„å¤‡çŸ¥è¯†ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210527173231.svg"></p>
<p>JPAå¼€å‘ç¯å¢ƒçš„æ­å»ºï¼š</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.hibernate<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hibernate-entitymanager<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${entitymanager.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${mysql.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ï¼ˆ1ï¼‰å‡†å¤‡æ•°æ®åº“ schema.sqlå’Œdata.sql</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> databse demo_web<span class="token punctuation">;</span>
<span class="token keyword">use</span> demo_web<span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> tb_usr <span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> tb_usr<span class="token punctuation">(</span>
                       id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">,</span>
                       name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                       password <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> tb_usr<span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> password<span class="token punctuation">)</span>
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'JackMa'</span><span class="token punctuation">,</span><span class="token string">'123456'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'RichardYu'</span><span class="token punctuation">,</span><span class="token string">'098765'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ï¼ˆ2ï¼‰å®šä¹‰ä¸æ•°æ®åº“å¯¹åº”çš„å®ä½“ç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"tb_usr"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Usr</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"password"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ï¼ˆ3ï¼‰é…ç½®æŒä¹…åŒ–å•å…ƒ</p>
<p>é…ç½®æ–‡ä»¶çš„æ ‡å‡†è·¯å¾„ï¼š<code>META-INF/persistence.xml</code></p>
<p>è¿™é‡Œé…ç½®çš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†è¯´æ˜æŒä¹…åŒ–æ‰€éœ€è¦çš„æ•°æ®åº“ä¿¡æ¯ï¼š</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!--JPA provider--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>provider</span><span class="token punctuation">&gt;</span></span>org.hibernate.jpa.HibernatePersistenceProvider<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>provider</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--entity class--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>class</span><span class="token punctuation">&gt;</span></span>cn.matemaster.entity.Usr<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>class</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--é…ç½®æŒä¹…åŒ–å•å…ƒ--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>persistence_unit</span> <span class="token attr-name">name</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>diy<span class="token punctuation">"</span></span> <span class="token attr-name">transaction-type</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>RESOURCE_LOCAL<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>javax.persistence.jdbc.driver<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.mysql.cj.jdbc.Driver<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>javax.persistence.jdbc.url<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jdbc:mysql://db_name<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>javax.persistence.jdbc.user<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>javax.persistence.jdbc.password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mysql_password<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>hibernate.show_sql<span class="token punctuation">"</span></span> <span class="token attr-name">value</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>hibernate.format_sql<span class="token punctuation">"</span></span> <span class="token attr-name">value</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>

        <span class="token comment">&lt;!--auto create table : update ? create--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>hibernate.hbm2ddl.auto<span class="token punctuation">"</span></span> <span class="token attr-name">value</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>update<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>persistence_unit</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ï¼ˆ4ï¼‰ä½¿ç”¨JPAæ“ä½œæ•°æ®åº“çš„æ­¥éª¤</p>
<ul>
<li>åˆ›å»ºå®ä½“ç®¡ç†å™¨å·¥å‚</li>
<li>ä½¿ç”¨å·¥å‚åˆ›å»ºå®ä½“ç®¡ç†å™¨</li>
<li>è·å–äº‹åŠ¡ï¼Œå¹¶ä¸”å¼€å¯äº‹åŠ¡</li>
<li>CRUDæ“ä½œ</li>
<li>æäº¤äº‹åŠ¡</li>
<li>å…³é—­èµ„æº</li>
</ul>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> persistenceUnit <span class="token operator">=</span> <span class="token string">"diy"</span><span class="token punctuation">;</span>

<span class="token class-name">EntityManagerFactory</span> factory <span class="token operator">=</span> <span class="token class-name">Persistence</span><span class="token punctuation">.</span><span class="token function">createEntityManagerFactory</span><span class="token punctuation">(</span>persistenceUnit<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">EntityManager</span> entityManager <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createEntityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">EntityTransaction</span> transaction <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">getTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transaction<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å¢</span>
entityManager<span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Usr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æŸ¥ã€æ”¹</span>
<span class="token class-name">Usr</span> usr <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">Usr</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
usr<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
entityManager<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>usr<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ </span>
entityManager<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>usr<span class="token punctuation">)</span><span class="token punctuation">;</span>

transaction<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

entityManager<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸‰ä¸ªé‡è¦çš„å¯¹è±¡ï¼šEntityManagerFactory ã€EntityManager ã€EntityTransaction<br>EntityManagerï¼šå¢åˆ æ”¹æŸ¥çš„APIæ“ä½œè€…ã€‚<br>EntityTransactionï¼šè´Ÿè´£äº‹åŠ¡çš„å¼€å¯ã€æäº¤ã€å›æ»š</p>
<p>åœ¨spring data jpaä¸‹çš„æ“ä½œæ•°æ®åº“ï¼š</p>
<p>spring data jpa æ˜¯åŸºäºjpaçš„åŸºç¡€ä¹‹ä¸Šï¼Œè®©ç”¨æˆ·ä¸“æ³¨äºDAOå±‚æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥å°†æ³¨æ„åŠ›æ”¾åœ¨DAOæ¥å£çš„å­¦ä¹ ä¸Šé¢ã€‚</p>
<p>è¿™é‡Œç®€å•äº†è§£ä¸€ä¸‹åœ¨spring dataä¸‹å¦‚ä½•å®Œæˆä¸Šé¢åŸå§‹jpaçš„é…ç½®æ“ä½œï¼š</p>
<ol>
<li>é…ç½®æ•°æ®æº</li>
<li>é…ç½® EntityManagerFactory Beanå®ä¾‹ï¼ˆæ•°æ®åº“æ“ä½œå¯¹è±¡ï¼‰</li>
<li>é…ç½® EntityTransaction Beanå®ä¾‹ï¼ˆäº‹åŠ¡ç®¡ç†å™¨ï¼‰</li>
<li>é…ç½®JPAä¸­å…¼å®¹äº†hibernateæ¡†æ¶çš„æ“ä½œ</li>
</ol>
<p>spring data jpa ä¸­é‡è¦çš„æ“ä½œæ¥å£</p>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210527190954.svg"></p>
<p>é€šè¿‡è‡ªå®šä¹‰å®ä½“ç±»çš„æ“ä½œæ¥å£å®ç°ç®€å•çš„å¢åˆ æ”¹æŸ¥ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UsrRepository</span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Usr</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>spring data jpa å®ç°æŸ¥è¯¢çš„å‡ ç§å¸¸ç”¨æ–¹å¼ï¼š</p>
<ul>
<li>åˆ©ç”¨çˆ¶æ¥å£æ–¹æ³•</li>
<li>æŒ‰ç…§jpaå‘½åè§„åˆ™</li>
<li>åˆ©ç”¨JPQL</li>
<li>ç›´æ¥åˆ©ç”¨æœ¬åœ°SQLï¼ˆå¤æ‚æŸ¥è¯¢å®ç°ï¼‰</li>
<li>åŠ¨æ€æŸ¥è¯¢çš„æ–¹å¼ï¼ˆå¤æ‚åŠ¨æ€æŸ¥è¯¢å®ç°ï¼‰</li>
</ul>
<ol>
<li>åˆ©ç”¨çˆ¶æ¥å£æ–¹æ³•ï¼ˆcrudï¼‰</li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**è‡ªå®šä¹‰DAOæ¥å£*/</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UsrRepository</span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Usr</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token comment">/**æµ‹è¯•åˆ©ç”¨è¯¥æ¥å£å¢åˆ æ”¹æŸ¥*/</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">daoUsr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Usr</span> mate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Usr</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"Master"</span><span class="token punctuation">,</span> <span class="token string">"12345378"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    usrRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>mate<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// usrRepository.deleteById(4);</span>

    <span class="token class-name">Usr</span> jMaster <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Usr</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"JMaster"</span><span class="token punctuation">,</span> <span class="token string">"09876542"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    usrRepository<span class="token punctuation">.</span><span class="token function">saveAndFlush</span><span class="token punctuation">(</span>jMaster<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Usr</span><span class="token punctuation">&gt;</span></span> all <span class="token operator">=</span> usrRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Usr</span> usr <span class="token operator">:</span> all<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>usr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>JPAæ–¹æ³•å‘½åè§„èŒƒï¼Œä»¥åŠè‡ªåŠ¨æ˜ å°„æˆçš„SQLè¯­å¥ï¼š</li>
</ol>
<table>
<thead>
<tr>
<th>Keyword</th>
<th>Sample</th>
<th>SQL</th>
</tr>
</thead>
<tbody><tr>
<td><code>And</code></td>
<td><code>findByLastnameAndFirstname</code></td>
<td><code>â€¦ where x.lastname = ?1 and x.firstname = ?2</code></td>
</tr>
<tr>
<td><code>Or</code></td>
<td><code>findByLastnameOrFirstname</code></td>
<td><code>â€¦ where x.lastname = ?1 or x.firstname = ?2</code></td>
</tr>
<tr>
<td><code>Is,Equals</code></td>
<td><code>findByFirstname</code>,<code>findByFirstnameIs</code>,<code>findByFirstnameEquals</code></td>
<td><code>â€¦ where x.firstname = ?1</code></td>
</tr>
<tr>
<td><code>Between</code></td>
<td><code>findByStartDateBetween</code></td>
<td><code>â€¦ where x.startDate between ?1 and ?2</code></td>
</tr>
<tr>
<td><code>LessThan</code></td>
<td><code>findByAgeLessThan</code></td>
<td><code>â€¦ where x.age &lt; ?1</code></td>
</tr>
<tr>
<td><code>LessThanEqual</code></td>
<td><code>findByAgeLessThanEqual</code></td>
<td><code>â€¦ where x.age &lt;= ?1</code></td>
</tr>
<tr>
<td><code>GreaterThan</code></td>
<td><code>findByAgeGreaterThan</code></td>
<td><code>â€¦ where x.age &gt; ?1</code></td>
</tr>
<tr>
<td><code>GreaterThanEqual</code></td>
<td><code>findByAgeGreaterThanEqual</code></td>
<td><code>â€¦ where x.age &gt;= ?1</code></td>
</tr>
<tr>
<td><code>After</code></td>
<td><code>findByStartDateAfter</code></td>
<td><code>â€¦ where x.startDate &gt; ?1</code></td>
</tr>
<tr>
<td><code>Before</code></td>
<td><code>findByStartDateBefore</code></td>
<td><code>â€¦ where x.startDate &lt; ?1</code></td>
</tr>
<tr>
<td><code>IsNull</code></td>
<td><code>findByAgeIsNull</code></td>
<td><code>â€¦ where x.age is null</code></td>
</tr>
<tr>
<td><code>IsNotNull,NotNull</code></td>
<td><code>findByAge(Is)NotNull</code></td>
<td><code>â€¦ where x.age not null</code></td>
</tr>
<tr>
<td><code>Like</code></td>
<td><code>findByFirstnameLike</code></td>
<td><code>â€¦ where x.firstname like ?1</code></td>
</tr>
<tr>
<td><code>NotLike</code></td>
<td><code>findByFirstnameNotLike</code></td>
<td><code>â€¦ where x.firstname not like ?1</code></td>
</tr>
<tr>
<td><code>StartingWith</code></td>
<td><code>findByFirstnameStartingWith</code></td>
<td><code>â€¦ where x.firstname like ?1</code>(parameter bound with appended <code>%</code>)</td>
</tr>
<tr>
<td><code>EndingWith</code></td>
<td><code>findByFirstnameEndingWith</code></td>
<td><code>â€¦ where x.firstname like ?1</code>(parameter bound with prepended <code>%</code>)</td>
</tr>
<tr>
<td><code>Containing</code></td>
<td><code>findByFirstnameContaining</code></td>
<td><code>â€¦ where x.firstname like ?1</code>(parameter bound wrapped in <code>%</code>)</td>
</tr>
<tr>
<td><code>OrderBy</code></td>
<td><code>findByAgeOrderByLastnameDesc</code></td>
<td><code>â€¦ where x.age = ?1 order by x.lastname desc</code></td>
</tr>
<tr>
<td><code>Not</code></td>
<td><code>findByLastnameNot</code></td>
<td><code>â€¦ where x.lastname &lt;&gt; ?1</code></td>
</tr>
<tr>
<td><code>In</code></td>
<td><code>findByAgeIn(Collection&lt;Age&gt; ages)</code></td>
<td><code>â€¦ where x.age in ?1</code></td>
</tr>
<tr>
<td><code>NotIn</code></td>
<td><code>findByAgeNotIn(Collection&lt;Age&gt; ages)</code></td>
<td><code>â€¦ where x.age not in ?1</code></td>
</tr>
<tr>
<td><code>True</code></td>
<td><code>findByActiveTrue()</code></td>
<td><code>â€¦ where x.active = true</code></td>
</tr>
<tr>
<td><code>False</code></td>
<td><code>findByActiveFalse()</code></td>
<td><code>â€¦ where x.active = false</code></td>
</tr>
<tr>
<td><code>IgnoreCase</code></td>
<td><code>findByFirstnameIgnoreCase</code></td>
<td><code>â€¦ where UPPER(x.firstame) = UPPER(?1)</code></td>
</tr>
</tbody></table>
<ol start="3">
<li>JPQLï¼ˆä¸“æ³¨é¢å‘å¯¹è±¡ç¼–å†™â€œSQLâ€ï¼‰</li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UsrRepository</span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Usr</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"from Usr where Usr.id = ?1"</span><span class="token punctuation">)</span>
    <span class="token class-name">Usr</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"from Usr where Usr .id = :id"</span><span class="token punctuation">)</span>
    <span class="token class-name">Usr</span> <span class="token function">query1</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>åˆ©ç”¨æœ¬åœ°SQLï¼Œå®ç°å¤æ‚æŸ¥è¯¢</li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**åªæŸ¥è¯¢ï¼Œä¸ä¿®æ”¹*/</span>
<span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"select d.* from sys_dept d, sys_roles_depts r where "</span> <span class="token operator">+</span>
        <span class="token string">"d.dept_id = r.dept_id and r.role_id = ?1"</span><span class="token punctuation">,</span> nativeQuery <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dept</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByRoleId</span><span class="token punctuation">(</span><span class="token class-name">Long</span> roleId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**ä¿®æ”¹æ•°æ®åº“æ•°æ®*/</span>
<span class="token annotation punctuation">@Modifying</span>
<span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">" update sys_dept set sub_count = ?1 where dept_id = ?2 "</span><span class="token punctuation">,</span>nativeQuery <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">void</span> <span class="token function">updateSubCntById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> count<span class="token punctuation">,</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="5">
<li>åŠ¨æ€æŸ¥è¯¢</li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dynamicUsr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    usrRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Specification</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Usr</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">Predicate</span> <span class="token function">toPredicate</span><span class="token punctuation">(</span><span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Usr</span><span class="token punctuation">&gt;</span></span> r<span class="token punctuation">,</span> <span class="token class-name">CriteriaQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> q<span class="token punctuation">,</span> <span class="token class-name">CriteriaBuilder</span> cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Spring Data Jpaå¤šè¡¨æ“ä½œï¼š</p>
<p>ï¼ˆ1ï¼‰ç¡®å®šè¡¨ä¸è¡¨ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼ˆä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹å¤šï¼‰</p>
<p>ï¼ˆ2ï¼‰åœ¨å®ä½“ç±»ä¹‹é—´æè¿°å®ä½“ä¹‹é—´çš„å…³ç³»</p>
<p>ï¼ˆ3ï¼‰é…ç½®å®ä½“ç±»å’Œæ•°æ®è¡¨ä¹‹é—´çš„æ˜ å°„å…³ç³»</p>
<p><code>@OneToOne</code>ã€<code>@OneToMany</code>ã€<code>@ManyToMany</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210530203455.png"></p>
<p>é¦–å…ˆå®šä¹‰å¯¼å¸ˆå’Œå­¦ç”Ÿä¹‹é—´çš„ä¸€å¯¹å¤šå…³ç³»ï¼š</p>
<ul>
<li>å¯¼å¸ˆç±»</li>
</ul>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"tb_tutor"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tutor</span> <span class="token punctuation">{</span>
    <span class="token comment">// æŒä¹…åŒ–ä¿¡æ¯(ä¸æ•°æ®åº“è¡¨çš„æ˜ å°„)</span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token comment">// è¡¨ä¹‹é—´çš„å…³ç³»å®šä¹‰</span>
    <span class="token annotation punctuation">@OneToMany</span><span class="token punctuation">(</span>mappedBy <span class="token operator">=</span> <span class="token string">"tutor"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> students <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>å­¦ç”Ÿç±»</li>
</ul>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"tb_student"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
    <span class="token comment">// æŒä¹…åŒ–ä¿¡æ¯(ä¸æ•°æ®åº“è¡¨çš„æ˜ å°„)</span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"tutor_id"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> tutorId<span class="token punctuation">;</span>

    <span class="token comment">// è¡¨ä¹‹é—´çš„å…³ç³»å®šä¹‰</span>
    <span class="token annotation punctuation">@ManyToOne</span>
    <span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"tutor_id"</span><span class="token punctuation">,</span>referencedColumnName <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Tutor</span> tutor<span class="token punctuation">;</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å…¶æ¬¡å†çœ‹å­¦ç”Ÿå’Œè¯¾ç¨‹ä¹‹é—´çš„å¤šå¯¹å¤šå…³ç³»ï¼š</p>
<ul>
<li>å­¦ç”Ÿç±»</li>
</ul>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"tb_student"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"tutor_id"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> tutorId<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ManyToMany</span><span class="token punctuation">(</span>mappedBy <span class="token operator">=</span> <span class="token string">"students"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Course</span><span class="token punctuation">&gt;</span></span> courses <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>è¯¾ç¨‹ç±»</li>
</ul>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"tb_course"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Course</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ManyToMany</span>
    <span class="token annotation punctuation">@JoinTable</span><span class="token punctuation">(</span>
            name <span class="token operator">=</span> <span class="token string">"tb_sc"</span><span class="token punctuation">,</span>
            joinColumns <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"cid"</span><span class="token punctuation">,</span>referencedColumnName <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            inverseJoinColumns <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"sid"</span><span class="token punctuation">,</span>referencedColumnName <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> students <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å› ä¸ºä¸­é—´è¡¨tb_scæ˜¯ä¸ºäº†è¡¨ç¤ºå­¦ç”Ÿå’Œè¯¾ç¨‹ä¹‹é—´çš„å…³ç³»è€Œå­˜åœ¨çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦ä¸“é—¨åˆ›å»ºå®ä½“ç±»å»å®ŒæˆæŒä¹…åŒ–ã€‚</p>
<h2 id="Spring-Security"><a href="#Spring-Security" class="headerlink" title="Spring Security"></a>Spring Security</h2><p>è®¤è¯æˆæƒæ¨¡å‹ï¼š</p>
<p>è®¤è¯ï¼šæ˜¯å¯¹äºè®¿é—®ç³»ç»Ÿç”¨æˆ·çš„åˆæ³•æ€§ã€‚æˆæƒï¼šåœ¨è®¤è¯é€šè¿‡ä¹‹åï¼Œæ§åˆ¶ç”¨æˆ·è®¿é—®ä¸åŒèµ„æºã€‚</p>
<p>æˆæƒçš„æ•°æ®æ¨¡å‹ï¼š</p>
<p>ä¸»ä½“ï¼ˆUsrï¼‰ï¼šä¸€èˆ¬å¤šæ˜¯ç”¨æˆ·</p>
<p>èµ„æºï¼ˆResourceï¼‰ï¼šåŒ…æ‹¬ä¸€äº›åŠŸèƒ½èµ„æºå’Œæ•°æ®èµ„æºï¼ˆæ•°æ®åº“ä¸­çš„ä¿¡æ¯ï¼‰</p>
<p>æƒé™ï¼ˆpermissionï¼‰ï¼šæ§åˆ¶ç”¨æˆ·èƒ½å¤Ÿè®¿é—®å“ªäº›èµ„æºï¼Œä¸èƒ½è®¿é—®å“ªäº›èµ„æº</p>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210601111917.svg"></p>
<p><code>RBAC</code>æˆæƒæ¨¡å‹ï¼š</p>
<p>ï¼ˆ1ï¼‰åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶</p>
<p>ï¼ˆ2ï¼‰åŸºäºèµ„æºçš„è®¿é—®æ§åˆ¶</p>
<p>ç¬¬ä¸€ç§åœ¨è¿›è¡Œè®¿é—®åŠŸèƒ½æ—¶ï¼Œé¦–å…ˆéªŒè¯å®ƒæ˜¯å¦æ˜¯æ‹¥æœ‰è¯¥æƒé™çš„è§’è‰²ï¼Œä»¥è§’è‰²ä¸ºéªŒè¯æ ¸å¿ƒã€‚ç¬¬äºŒç§åœ¨è¿›è¡Œè®¿é—®åŠŸèƒ½æ—¶ï¼Œé¦–å…ˆéªŒè¯å®ƒæ˜¯å¦æ‹¥æœ‰è¯¥èµ„æºè®¿é—®çš„æƒé™ï¼Œä»¥èµ„æºè®¿é—®æƒé™æ ‡è¯†ä¸ºæ ¸å¿ƒã€‚</p>
<p>springbootä¸­å…³äºsecurityçš„è¿ç”¨ï¼š</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨å¼•å…¥ä¾èµ–ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å¼€å¯springbootæä¾›çš„securityæœåŠ¡ï¼šé€šå¸¸æ˜¯ä½¿ç”¨ä¸€ä¸ªé…ç½®ç±»ä»¥å®ç°æ¥ä¸‹æ¥çš„è®¤è¯æˆæƒæ“ä½œã€‚</p>
<p>åœ¨ä¸‹é¢çš„é…ç½®ç±»ä¸­æˆ‘ä»¬å¯ä»¥å®Œæˆä¸‰ä»¶äº‹æƒ…ï¼š</p>
<ol>
<li>å…³äºç”¨æˆ·çš„ä¿¡æ¯æœåŠ¡ï¼ˆUserDetailsServiceï¼‰ï¼šæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯çš„é‡è¦æ¥å£</li>
<li>å¯†ç çš„ç¼–ç æ–¹å¼ï¼ˆPasswordEncoderï¼‰</li>
<li>webè¯·æ±‚çš„æ‹¦æˆªæœºåˆ¶ï¼ˆconfigure(HttpSecurity httpSecurity)ï¼‰</li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token comment">// @EnableWebSecurity:å¼€å¯securityæœåŠ¡</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSecurity</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">PasswordEncoder</span> <span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span>http<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>spring-security-è®¤è¯è¿‡ç¨‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210605205318.svg"></p>
<p> spring-security-æˆæƒï¼š</p>
<p>ï¼ˆ1ï¼‰webæˆæƒ</p>
<p>ï¼ˆ2ï¼‰æ–¹æ³•æˆæƒ</p>
<p>webæˆæƒä¸»è¦æ—¶åˆ©ç”¨springsecurityä¸­çš„é…ç½®ç±»å®ç°ç›¸åº”çš„æ¥å£æ‹¦æˆª</p>
<p>æ–¹æ³•æˆæƒåˆ™ä¸»è¦å‘ç”Ÿåœ¨æ§åˆ¶å™¨ä¸Šï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableWebSecurity</span>
<span class="token comment">// å¼€å¯æ–¹æ³•æˆæƒï¼š@EnableGlobalMethodSecurity(prePostEnabled = true, securedEnabled = true)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringSecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><h2 id="å¼‚æ­¥åŒ–æ¶ˆæ¯å¤„ç†"><a href="#å¼‚æ­¥åŒ–æ¶ˆæ¯å¤„ç†" class="headerlink" title="å¼‚æ­¥åŒ–æ¶ˆæ¯å¤„ç†"></a>å¼‚æ­¥åŒ–æ¶ˆæ¯å¤„ç†</h2><p>ä¸‰ç§å¼‚æ­¥åŒ–æ¶ˆæ¯å¤„ç†æŠ€æœ¯æ ˆï¼šJMSã€RabbitMQã€</p>
<p><strong>æˆ‘ä»¬ä¸»è¦èšç„¦äºå¦‚ä½•ä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶å‘é€æ¶ˆæ¯å’Œæ¥å—æ¶ˆæ¯</strong></p>
<hr>
<p><b style="color:red">JMS</b></p>
<p>springå¯¹äºJMSæŠ€æœ¯çš„æ”¯æŒæ˜¯<code>JmsTemplate</code>ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¯¥ç±»å®ç°å‘é€æ¶ˆæ¯å’Œæ¥å—æ¶ˆæ¯</p>
<p>å…³äºartmeisæ¶ˆæ¯ä»£ç†çš„é…ç½®</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">artemis</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> www.matemaster.cn
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
    <span class="token key atrule">user</span><span class="token punctuation">:</span> matemaster
    <span class="token key atrule">password</span><span class="token punctuation">:</span> Mashimaro980<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨spring bootä¸­åº”ç”¨JMSæŠ€æœ¯æ ˆ</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-artemis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¥ä¸‹æ¥éœ€è¦äº†è§£å…³äº<code>JmsTemplate</code>ä¸­å‘é€æ¶ˆæ¯çš„api</p>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210517155618.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210517155622.png"></p>
<p>å…³äº<code>send</code>å’Œ<code>convertAndSend</code>ä¹‹é—´çš„åŒºåˆ«å°±åœ¨äºï¼ŒMessageå¯¹è±¡å®ä¾‹ï¼Œä¸€ä¸ªå‘ç”Ÿåœ¨å°å‰ä¸€ä¸ªå‘ç”Ÿåœ¨å¹•åï¼ä¼˜ç¼ºç‚¹æ˜¾è€Œæ˜“è§ï¼šsendå¯ä»¥å®šä¹‰Messsageå¯¹è±¡çš„å±æ€§å’Œæ¶ˆæ¯å¤´ï¼Œè€ŒconvertAndSendå‡å°‘äº†Messageå¯¹è±¡çš„ç”Ÿæˆï¼Œä½†æ˜¯éœ€è¦å€ŸåŠ©<code>MessagePostProcessor</code>æ¥å¤„ç†åæœŸå¯¹äºMessageå¯¹è±¡çš„å±æ€§å’Œæ¶ˆæ¯å¤´ï¼</p>
<p><strong>æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹sendåœ¨å…·ä½“ä¸šåŠ¡ä¸­çš„åº”ç”¨</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JmsOrderMessagingService</span> <span class="token keyword">implements</span> <span class="token class-name">OrderMessagingService</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token class-name">JmsTemplate</span> jms<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">JmsOrderMessagingService</span><span class="token punctuation">(</span><span class="token class-name">JmsTemplate</span> jms<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>jms <span class="token operator">=</span> jms<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/**è¿™é‡Œsendæ–¹æ³•ç±»lambdaå®ç°çš„æ˜¯MessageCreatoræ¥å£*/</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        jms<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>session <span class="token operator">-&gt;</span> session<span class="token punctuation">.</span><span class="token function">createObjectMessage</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å› ä¸ºåœ¨è¿™é‡Œå¹¶æ²¡æœ‰ä¼ å…¥ç›®çš„åœ°å‚æ•°ï¼ˆDestinationå®ä¾‹ï¼‰ï¼Œæ‰€ä»¥æ¶ˆæ¯å°±ä¼šè¢«è·¯ç”±åˆ°é»˜è®¤ç›®çš„åœ°ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨é…ç½®æ¥è®¾å®šé»˜è®¤çš„ç›®çš„åœ°</p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">jms</span><span class="token punctuation">:</span>
    <span class="token key atrule">template</span><span class="token punctuation">:</span>
      <span class="token key atrule">default-destination</span><span class="token punctuation">:</span> matemaster.default.queue<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ç›®çš„åœ°ä½œä¸ºbeanæ³¨å…¥åˆ°spring bootçš„å®¹å™¨å½“ä¸­</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">Destination</span> <span class="token function">messageQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ActiveMQQueue</span><span class="token punctuation">(</span><span class="token string">"matemaster.default.queue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>é™¤äº†é»˜è®¤çš„ç›®çš„åœ°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­ç¡¬ç¼–ç è®¾ç½®ç›®çš„åœ°</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JmsOrderMessagingService</span> <span class="token keyword">implements</span> <span class="token class-name">OrderMessagingService</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token class-name">JmsTemplate</span> jms<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Destination</span> mq<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">JmsOrderMessagingService</span><span class="token punctuation">(</span><span class="token class-name">JmsTemplate</span> jms<span class="token punctuation">,</span> <span class="token class-name">Destination</span> mq<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>jms <span class="token operator">=</span> jms<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>des <span class="token operator">=</span> mq<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        jms<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>mq<span class="token punctuation">,</span>session <span class="token operator">-&gt;</span> session<span class="token punctuation">.</span><span class="token function">createObjectMessage</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯ç›´æ¥ä¼ å…¥ç›®çš„åœ°çš„åç§°ä»¥å®ç°è®¾ç½®ç›®çš„åœ°</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    jms<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"mq"</span><span class="token punctuation">,</span>session <span class="token operator">-&gt;</span> session<span class="token punctuation">.</span><span class="token function">createObjectMessage</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹convertAndSendåœ¨å…·ä½“ä¸šåŠ¡ä¸­çš„åº”ç”¨</strong></p>
<p>å› ä¸ºè¿™é‡Œåœ¨æ–¹æ³•çš„åº•å±‚ä¸­ï¼Œå¤šäº†ä¸€ä¸ªç±»å‹çš„è½¬æ¢ï¼šé¢†åŸŸå¯¹è±¡===&gt;Messageå¯¹è±¡ï¼Œè¿™é‡Œæ¶‰åŠä¸€ä¸ªæ¥å£ï¼š<code>MessageConvert</code></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MessageConverter</span> <span class="token punctuation">{</span>
    <span class="token class-name">Message</span> <span class="token function">toMessage</span><span class="token punctuation">(</span><span class="token class-name">Object</span> var1<span class="token punctuation">,</span> <span class="token class-name">Session</span> var2<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">JMSException</span><span class="token punctuation">,</span> <span class="token class-name">MessageConversionException</span><span class="token punctuation">;</span>

    <span class="token class-name">Object</span> <span class="token function">fromMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> var1<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">JMSException</span><span class="token punctuation">,</span> <span class="token class-name">MessageConversionException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨springæ¡†æ¶ä¸­å·²ç»æä¾›äº†è¯¥æ¥å£çš„å®ç°ç±»ï¼šæ¥å£è½¬æ¢å™¨</p>
<ul>
<li>MappingJson2MessageConverter</li>
<li>MarshallingMessageConverter</li>
<li>MessagingMessageConverter</li>
<li>SimpleMessageConverter</li>
</ul>
<p>å¦‚æœæˆ‘ä»¬éœ€è¦ä½¿ç”¨å¯¹äºçš„æ¥å£è½¬æ¢å™¨ï¼Œåªéœ€è¦ä»¥Beançš„å½¢å¼æ³¨å…¥åˆ°å®¹å™¨ä¸­å³å¯ã€‚æ¯”å¦‚ä¸‹é¢çš„è½¬æ¢å™¨ï¼Œå°±å¯ä»¥è‡ªåŠ¨å°†Orderé¢†åŸŸå¯¹è±¡ï¼Œè½¬ä¸ºå¯¹åº”çš„Messageå¯¹è±¡</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">MappingJson2MessageConverter</span> <span class="token function">messageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">MappingJson2MessageConverter</span> mc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MappingJson2MessageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mc<span class="token punctuation">.</span><span class="token function">setTypeIdPropertyName</span><span class="token punctuation">(</span><span class="token string">"_typeId"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"order"</span><span class="token punctuation">,</span> <span class="token class-name">Order</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mc<span class="token punctuation">.</span><span class="token function">setTypeIdMappings</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> mc<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å› ä¸ºè½¬æ¢å™¨å°†å¯¹è±¡è½¬æ¢ä¸ºMessageå¯¹è±¡ï¼Œæ˜¯åœ¨åå°è‡ªåŠ¨å®Œæˆçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸èƒ½å¤Ÿåƒsendé‚£æ ·ç›´æ¥åœ¨æ–¹æ³•å‚æ•°ä¸­å®šä¹‰æœ‰å…³Messageå¯¹è±¡çš„ä¿¡æ¯ï¼Œä½†æ˜¯è¿˜å¯ä»¥åˆ©ç”¨MessagePostProcessoråšå…³äºMessageå¯¹è±¡çš„å¤„ç†ï¼</p>
<ol>
<li>åœ¨sendä¸­å®šä¹‰Messageå¯¹è±¡çš„å±æ€§ </li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    jsm<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"matemaster.diy.queue"</span><span class="token punctuation">,</span>
             session <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                 <span class="token class-name">Message</span> msg <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createObjectMessage</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
                 msg<span class="token punctuation">.</span><span class="token function">setStringProperty</span><span class="token punctuation">(</span><span class="token string">"X_ORDER_SOURCE"</span><span class="token punctuation">,</span> <span class="token string">"WEB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸ä»…ç”Ÿæˆäº†Messageå¯¹è±¡ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ªå±æ€§ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨convertAndSendæ–¹æ³•ä¸­å®ç°åŒæ ·çš„æ“ä½œ</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    jsm<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"matemaster.diy.queue"</span><span class="token punctuation">,</span> order<span class="token punctuation">,</span> 
             message <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                 <span class="token class-name">Message</span> msg <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createObjectMessage</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token keyword">return</span> message<span class="token punctuation">;</span>
             <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><b style="color:blue">è‡³æ­¤ï¼šå…³äºå¦‚ä½•ä½¿ç”¨JMSå‘é€æ¶ˆæ¯ç®€è¿°å®Œæ¯•ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦äº†è§£çš„å°±æ˜¯å¦‚ä½•æ¥å—JMSæ¶ˆæ¯ï¼Ÿ</b></p>
<p>æ¥å—æ¶ˆæ¯å­˜åœ¨ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li>pullï¼šè¯·æ±‚æ¶ˆæ¯ï¼Œä¼šç­‰å¾…æ¶ˆæ¯åˆ°è¾¾ä½ç½®</li>
<li>pushï¼šåœ¨æ¶ˆæ¯å¯ç”¨æ—¶ï¼Œæ¥å—æ¶ˆæ¯</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210517190203.png"></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JmsOrderReceiver</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">JmsTemplate</span> jms<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">MessageConverter</span> converter<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">JmsOrderReceiver</span><span class="token punctuation">(</span><span class="token class-name">JmsTemplate</span> jms<span class="token punctuation">,</span> <span class="token class-name">MessageConverter</span> converter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>jms <span class="token operator">=</span> jms<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>converter <span class="token operator">=</span> converter<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**è·å–é»˜è®¤ç›®çš„åœ°çš„ä¿¡æ¯ï¼Œå¹¶ä¸”è½¬æ¢æˆOrderå¯¹è±¡*/</span>
    <span class="token keyword">public</span> <span class="token class-name">Order</span> <span class="token function">receiveOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Message</span> msg <span class="token operator">=</span> jms<span class="token punctuation">.</span><span class="token function">receive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Order</span><span class="token punctuation">)</span> converter<span class="token punctuation">.</span><span class="token function">fromMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨receiveAndConvertæ–¹æ³•å®ç°è‡ªåŠ¨è½¬æ¢</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Order</span> <span class="token function">receiveOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Order</span><span class="token punctuation">)</span> jms<span class="token punctuation">.</span><span class="token function">receiveAndConvert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœæƒ³è¦å®ç°pushæ¨¡å¼ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªç›‘å¬å™¨ï¼Œæ¥æ£€æµ‹å½“å‰æ¶ˆæ¯æ˜¯å¦å¯ç”¨</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@JmsListener</span><span class="token punctuation">(</span>destination <span class="token operator">=</span> <span class="token string">"matemaster.diy.queue"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¸¦æœ‰<code>@JmsListener</code>æ³¨è§£çš„æ–¹æ³•å°†ä¼šè¢«æ³¨å†Œä¸ºä¸€ä¸ªJMSæ¶ˆæ¯ç›‘å¬å™¨ï¼Œä»–ä¼šè‡ªåŠ¨è·å–æ¶ˆæ¯ä¸­çš„è½½è·ä½œä¸ºå‚æ•°orderä¼ å…¥åˆ°æ–¹æ³•ä¸­å»ï¼</p>
<p><b style="color:blue">è‡³æ­¤ï¼šJMSæŠ€æœ¯æ ˆç®€è¿°å®Œæ¯•ï¼Œæ¥ä¸‹æ¥å°†ä¼šç»§ç»­å­¦ä¹ RabbitMQ</b></p>
<hr>
<p><b style="color:red">RabbitMQ</b></p>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210517190207.png"></p>
<p>ç”±ä¸Šå›¾å¯ç”¨çœ‹å‡ºï¼Œåœ¨RabbitMQä¸­ï¼ŒExchangeå’Œrouting keyã€bindingæ˜¯è·¯ç”±åˆ°æ¶ˆæ¯é˜Ÿåˆ—çš„å…³é”®ï¼</p>
<p>Exchangeå¤§æ¦‚å­˜åœ¨å…­ç§ç±»å‹ï¼š</p>
<ul>
<li>Default</li>
<li>Direct</li>
<li>Topic</li>
<li>Fanout</li>
<li>Headers</li>
<li>Dead letter</li>
</ul>
<p>åœ¨spring bootä¸­åº”ç”¨RabbitMQæŠ€æœ¯æ ˆ</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-amqp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å…³äºRabbitMQä»£ç†çš„é…ç½®</p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">addresses</span><span class="token punctuation">:</span> rabbit.matemaster.cn
    <span class="token key atrule">host</span><span class="token punctuation">:</span> localhost
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5673</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> rabbitweb
    <span class="token key atrule">password</span><span class="token punctuation">:</span> xxxxxx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œä¹Ÿèšç„¦äºRabbitMQå¦‚ä½•å‘é€æ¶ˆæ¯å’Œæ¥æ”¶æ¶ˆæ¯</p>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210517191343.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210517191710.png"></p>
<p>RabbitMQå‘é€æ¶ˆæ¯çš„æ–¹å¼ä¸JMSåŸºæœ¬ä¸€è‡´ï¼Œåªæ˜¯å¯¹äºRabbitMQ Exchange ä»–éœ€è¦æ ¹æ®æ¶ˆæ¯çš„ routing key å–å°†æ¶ˆæ¯è·¯ç”±åˆ°æŒ‡å®šçš„é˜Ÿåˆ—ä¸­ã€‚<strong>å¦å¤–ä¸€ä¸ªè¦ç‚¹å°±æ˜¯ï¼š</strong>RabbitMQå­˜åœ¨é»˜è®¤çš„æ¶ˆæ¯è½¬æ¢å™¨ã€‚æˆ‘ä»¬å¯ç”¨ä½¿ç”¨<code>getMessageConverter()</code>æ–¹æ³•è·å–åˆ°é»˜è®¤çš„è½¬æ¢å™¨ï¼</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitOrderMessagingService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">RabbitTemplate</span> rabbit<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">RabbitOrderMessagingService</span><span class="token punctuation">(</span><span class="token class-name">RabbitTemplate</span> rabbit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>rabbit <span class="token operator">=</span> rabbit<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// RabbitMQæä¾›çš„é»˜è®¤æ¶ˆæ¯è½¬æ¢å™¨</span>
        <span class="token class-name">MessageConverter</span> converter <span class="token operator">=</span> rabbit<span class="token punctuation">.</span><span class="token function">getMessageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MessageProperties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MessageProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Message</span> msg <span class="token operator">=</span> converter<span class="token punctuation">.</span><span class="token function">toMessage</span><span class="token punctuation">(</span>order<span class="token punctuation">,</span> properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbit<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œå‘é€å‡ºå»çš„msgå°†ä¼šé‡‡å–é»˜è®¤çš„ Exchange å’Œ routing key ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®çš„æ–¹å¼å»è®¾å®šé»˜è®¤</p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">template</span><span class="token punctuation">:</span>
      <span class="token key atrule">exchange</span><span class="token punctuation">:</span> rabbit.matemaster.exchange
      <span class="token key atrule">routing-key</span><span class="token punctuation">:</span> routing.key<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åŒæ ·çš„æˆ‘ä»¬å¯ç”¨ä½¿ç”¨convertAndSendæ¥ç®€åŒ–å‘é€æ“ä½œ</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    rabbit<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">"matemaster.diy.queue"</span><span class="token punctuation">,</span> order<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ä¸Šé¢æåˆ°è¿‡RabbitMQå¯ä»¥æä¾›çš„é»˜è®¤æ¶ˆæ¯è½¬æ¢å™¨ã€‚åœ¨springä¸­ä¹Ÿä¸ºRabbitTemplateæä¾›äº†å¤šç§æ¶ˆæ¯è½¬æ¢å™¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼å–æ›¿æ¢æ‰RabbitMQæä¾›çš„é»˜è®¤æ¶ˆæ¯è½¬æ¢å™¨ã€‚</p>
<p>springä¸­ä¸ºRabbitTemplateæä¾›çš„æ¶ˆæ¯è½¬æ¢å™¨ï¼š</p>
<ul>
<li>Jackson2JsonMessageConverter</li>
<li>MarshallingMessageConverter</li>
<li>SerializerMessageConverter</li>
<li>SimpleMessageConverter</li>
<li>ContentTypeDelegatingMessageConverter</li>
<li>MessagingMessageConverter</li>
</ul>
<p>æ›¿æ¢é»˜è®¤æ¶ˆæ¯è½¬æ¢å™¨çš„ä»£ç </p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">MessageConverter</span> <span class="token function">messageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonMessageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å°†Jackson2JsonMessageConverterå¯¹è±¡å®ä¾‹ï¼Œä»¥beanæ³¨å…¥åˆ°spring bootå®¹å™¨ä¸­ï¼Œspring bootå°†ä¼šå®Œæˆæ›¿æ¢å·¥ä½œï¼</p>
<p>ç±»ä¼¼æˆ‘ä»¬åœ¨RabbitMQä¸­ä½¿ç”¨å¸¦æœ‰MessagePostProcessorå¯¹æ¶ˆæ¯å¯¹è±¡åšåç»­å¤„ç†ï¼</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    rabbit<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span>order<span class="token punctuation">,</span>
                         message <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                             <span class="token class-name">MessageProperties</span> pro <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getMessageProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                             pro<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"X_ORDER_SOURCE"</span><span class="token punctuation">,</span> <span class="token string">"WEB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                             <span class="token keyword">return</span> message<span class="token punctuation">;</span>
                         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><b style="color:blue">è‡³æ­¤ï¼šå…³äºå¦‚ä½•ä½¿ç”¨RabbitMQå‘é€æ¶ˆæ¯ç®€è¿°å®Œæ¯•ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦äº†è§£çš„å°±æ˜¯å¦‚ä½•æ¥å—RabbitMQæ¶ˆæ¯ï¼Ÿ</b></p>
<p>ä¸JMSç›¸ä¼¼ï¼ŒRabbitMQä¹Ÿæœ‰ä¸¤ç§æ¥å—æ¶ˆæ¯çš„æ–¹æ¡ˆï¼š</p>
<ul>
<li>ä½¿ç”¨RabbitTemplateä»é˜Ÿåˆ—ä¸­æ‹‰å–æ¶ˆæ¯</li>
<li>å°†æ¶ˆæ¯æ¨é€åˆ°å¸¦æœ‰@RabbitListeneræ³¨è§£çš„æ–¹æ³•</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210517194546.png"></p>
<p>RabbitMQæ¥å—æ¶ˆæ¯ä¹Ÿæ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šï¼Œéƒ½æ˜¯æ¥å—æ¶ˆæ¯ç„¶åå¯¹æ¶ˆæ¯åšä¸šåŠ¡å¤„ç†ï¼ˆè·å–æ¶ˆæ¯å¤´ã€è½¬æ¢å¯¹è±¡ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥å¯ä»¥é€šè¿‡é…ç½®çš„æ–¹å¼ï¼Œå†³å®šæ‹‰å–ç­‰å¾…çš„è¶…æ—¶æ—¶é—´ï¼š</p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">template</span><span class="token punctuation">:</span>
      <span class="token key atrule">receive-timeout</span><span class="token punctuation">:</span> <span class="token number">3000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯¹äºRabbitMQçš„æ¶ˆæ¯è½¬æ¢ï¼Œéœ€è¦ä¸€ä¸ªParameterizedTypeReferenceå‚æ•°ã€‚å¹¶ä¸”ä½¿ç”¨è¿™ä¸ªå‚æ•°æ—¶ï¼Œæ¶ˆæ¯è½¬åŒ–å™¨<strong>å¿…é¡»è¦å®ç°è¿™ä¸ªæ¥å£ï¼šSmartMessageConverterã€‚è€Œç›®å‰åªæœ‰Jackson2JsonMessageConverterå®ç°äº†</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Order</span> <span class="token function">receiveOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> rabbit<span class="token punctuation">.</span><span class="token function">receiveAndConvert</span><span class="token punctuation">(</span><span class="token string">"matemaster.diy.queue"</span><span class="token punctuation">,</span>
                    <span class="token keyword">new</span> <span class="token class-name">ParameterizedTypeReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Order</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ¥ä¸‹æ¥éœ€è¦ä»‹ç»å¦‚ä½•ä½¿ç”¨@RabbitListeneræ³¨è§£çš„æ–¹æ³•</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>destination <span class="token operator">=</span> <span class="token string">"matemaster.diy.queue"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dispalyOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><b style="color:blue">è‡³æ­¤ï¼šRabbitMQæŠ€æœ¯æ ˆç®€è¿°å®Œæ¯•ï¼Œç¼–ç¨‹æ¨¡å‹åŸºæœ¬ä¸JMSä¿æŒä¸€è‡´ï¼Œæ¥ä¸‹æ¥éœ€è¦äº†è§£çš„æ˜¯Kafka</b></p>
<hr>
<p><b style="color:red">Kafka</b></p>
<h2 id="JSON-Web-Token"><a href="#JSON-Web-Token" class="headerlink" title="JSON Web Token"></a>JSON Web Token</h2><p>è®¤è¯æµç¨‹å›¾ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210526150348.svg"></p>
<p>JSON Web Tokençš„ç»“æ„ï¼š</p>
<ul>
<li>Header</li>
<li>Playload</li>
<li>Signature</li>
</ul>
<p>ä»¤ç‰Œçš„æ ¼å¼ï¼š<code>token: Header.Playload.Signature</code></p>
<p>Headerï¼ˆæ ‡å¤´ï¼‰çš„ç»„æˆï¼šä»¤ç‰Œçš„ç±»å‹ã€ä½¿ç”¨çš„ç­¾åç®—æ³•ã€‚ä¸‹é¢å°±æ˜¯ä¸€ä¸ªæ ‡å‡†çš„æ ‡å¤´çš„JSONå¯¹è±¡â€”â€”æ˜æ–‡ï¼Œåé¢ä¼šä½¿ç”¨Base64è¿›è¡Œç¼–ç </p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"alg"</span><span class="token operator">:</span> <span class="token string">"HS256"</span><span class="token punctuation">,</span>
    <span class="token property">"typ"</span><span class="token operator">:</span> <span class="token string">"JWT"</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>PLayloadï¼ˆæœ‰æ•ˆè´Ÿè½½ï¼‰ï¼šå…¶ä¸­åŒ…å«äº†å…³äºæœ‰å…³å®ä½“çš„åŠæ›¿ä»–æ•°æ®çš„å£°æ˜ï¼Œåé¢ä¼šä½¿ç”¨Base64è¿›è¡Œç¼–ç ã€‚</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"sub"</span><span class="token operator">:</span> <span class="token string">"1234567890"</span><span class="token punctuation">,</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"MateMaster"</span><span class="token punctuation">,</span>
    <span class="token property">"admin"</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Signatureï¼ˆç­¾åï¼‰ï¼šç­¾åçš„ç”Ÿæˆï¼Œæ˜¯åˆ©ç”¨å‰é¢å·²ç»ç¼–ç çš„Headerå’ŒPlayloadåŸºç¡€ä¹‹ä¸Šï¼ŒåŠ ä¸Šæˆ‘ä»¬æä¾›çš„å¯†é’¥ï¼Œä½¿ç”¨ä¸Šé¢å¤´éƒ¨å£°æ˜çš„ç­¾åç®—æ³•è¿›è¡Œç­¾åç”Ÿæˆï¼</p>
<ul>
<li>Base64(Header)</li>
<li>Base64(PLayload)</li>
<li>secret</li>
</ul>
<p>JSON Web Tokenåœ¨Javaç¨‹åºä¸­çš„è¿ç”¨ï¼š</p>
<ol>
<li>å¯¼å…¥ä¾èµ–</li>
</ol>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.auth0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>java-jwt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${jwt.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>åˆ©ç”¨JWTçš„apiè¿›è¡Œå…³äºtokençš„æ“ä½œ</li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> token <span class="token operator">=</span> JWT<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">withHeader</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">withClaim</span><span class="token punctuation">(</span><span class="token string">"userId"</span><span class="token punctuation">,</span> <span class="token number">1998</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">withClaim</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span> <span class="token string">"MateMaster"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">withExpiresAt</span><span class="token punctuation">(</span>calendar<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token class-name">Algorithm</span><span class="token punctuation">.</span><span class="token function">HMAC256</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åˆ†åˆ«åˆ©ç”¨ä¸€ç³»åˆ—çš„withæ–¹æ³•å¯¹Header.Playload.Signatureè¿›è¡Œè®¾ç½®</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">JWTVerifier</span> verifier <span class="token operator">=</span> JWT<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token class-name">Algorithm</span><span class="token punctuation">.</span><span class="token function">HMAC256</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">DecodedJWT</span> decodedJWT <span class="token operator">=</span> verifier<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è§£å¯†tokenå¹¶ä¸”è·å–tokenä¸­çš„ç›¸å…³ä¿¡æ¯</p>
<p>å°†ä¸Šé¢çš„æ“ä½œåŒ…è£…æˆä¸€ä¸ªå·¥å…·ç±»ï¼ˆåŒ…å«tokençš„ç”Ÿæˆå’ŒéªŒè¯ï¼‰</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JWTUtil</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SECRET <span class="token operator">=</span> <span class="token string">"@#^&amp;*(*&amp;^%$CBAOVB"</span><span class="token punctuation">;</span>
    
    <span class="token comment">/**mapåŒ…å«äº†playloadçš„å…¨éƒ¨å†…å®¹*/</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">generateToken</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">JWTCreator<span class="token punctuation">.</span>Builder</span> builder <span class="token operator">=</span> JWT<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        map<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>v<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            builder<span class="token punctuation">.</span><span class="token function">withClaim</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Calendar</span> calendar <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        calendar<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>DATE<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Date</span> date <span class="token operator">=</span> calendar<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        builder<span class="token punctuation">.</span><span class="token function">withExpiresAt</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token class-name">Algorithm</span><span class="token punctuation">.</span><span class="token function">HMAC256</span><span class="token punctuation">(</span>SECRET<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**ä¸»è¦éªŒè¯tokenæ˜¯å¦è¿‡æœŸ*/</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">verify</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        JWT<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token class-name">Algorithm</span><span class="token punctuation">.</span><span class="token function">HMAC256</span><span class="token punctuation">(</span>SECRET<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**è·å–tokençš„æ˜æ–‡ä¿¡æ¯åŠç¼–ç ä¿¡æ¯*/</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">DecodedJWT</span> <span class="token function">getToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> JWT<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token class-name">Algorithm</span><span class="token punctuation">.</span><span class="token function">HMAC256</span><span class="token punctuation">(</span>SECRET<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Swagger2"><a href="#Swagger2" class="headerlink" title="Swagger2"></a>Swagger2</h2><ul>
<li>swagger2ä¾èµ–</li>
<li>swagger2é…ç½®</li>
<li>swagger2æ³¨è§£</li>
</ul>
<p>swaggeræ˜¯æœ€æµè¡Œçš„Apiæ¡†æ¶ï¼Œåœ¨spring bootä¸­çš„é›†æˆï¼š</p>
<p>springfox-swagger2ï¼šåŒ…å«äº†swagger-annotationsã€swagger-models</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.springfox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>springfox-swagger2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${swagger.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.springfox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>springfox-swagger-ui<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${swagger.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å› ä¸ºswaggerå±äºç¬¬ä¸‰æ–¹çš„æŠ€æœ¯æ ˆï¼Œå¹¶æ²¡æœ‰ä¸“é—¨çš„åœºæ™¯å¯åŠ¨å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œé…ç½®æ‰å¯ä»¥ä½¿ç”¨</p>
<p>é…ç½®swaggerï¼šæ­¤æ—¶é‡‡å–é»˜è®¤é…ç½®çš„æ–¹å¼ï¼</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableSwagger2</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Swagger2Config</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>æ¥ä¸‹æ¥ä¸»è¦ä»‹ç»ä¸€ä¸‹å…³äº<code>swagger2</code>çš„è¯¦ç»†é…ç½®</p>
<p>ï¼ˆ1ï¼‰é…ç½®swagger2ç‰ˆæœ¬</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Docket</span> docket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Docket</span><span class="token punctuation">(</span><span class="token class-name">DocumentationType</span><span class="token punctuation">.</span>SWAGGER_2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ï¼ˆ2ï¼‰é…ç½®é¡µé¢Apiçš„æè¿°ä¿¡æ¯ apiInfo</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">docket <span class="token operator">=</span> docket<span class="token punctuation">.</span><span class="token function">apiInfo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ApiInfo</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**ApiInfoå¯¹è±¡æ„é€ å™¨*/</span>
<span class="token keyword">public</span> <span class="token class-name">ApiInfo</span><span class="token punctuation">(</span><span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">String</span> description<span class="token punctuation">,</span> <span class="token class-name">String</span> version<span class="token punctuation">,</span> <span class="token class-name">String</span> termsOfServiceUrl<span class="token punctuation">,</span> <span class="token class-name">Contact</span> contact<span class="token punctuation">,</span> <span class="token class-name">String</span> license<span class="token punctuation">,</span> <span class="token class-name">String</span> licenseUrl<span class="token punctuation">,</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">VendorExtension</span><span class="token punctuation">&gt;</span></span> vendorExtensions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>description <span class="token operator">=</span> description<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>version <span class="token operator">=</span> version<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>termsOfServiceUrl <span class="token operator">=</span> termsOfServiceUrl<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>contact <span class="token operator">=</span> contact<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>license <span class="token operator">=</span> license<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>licenseUrl <span class="token operator">=</span> licenseUrl<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>vendorExtensions <span class="token operator">=</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span>vendorExtensions<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**è”ç³»æ–¹å¼*/</span>
<span class="token keyword">public</span> <span class="token class-name">Contact</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> url<span class="token punctuation">,</span> <span class="token class-name">String</span> email<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> url<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>email <span class="token operator">=</span> email<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸Šé¢æ˜¯ApiInfoçš„æ„é€ å‡½æ•°ï¼ŒåŒ…å«äº†Apiæ–‡æ¡£æè¿°ï¼šæ ‡é¢˜ã€æè¿°ã€ç‰ˆæœ¬ã€å›¢é˜ŸæœåŠ¡é“¾æ¥ã€è”ç³»æ–¹å¼ã€å¼€æºåè®®ã€åè®®é“¾æ¥ã€æ‹“å±•ã€‚</p>
<p>ï¼ˆ3ï¼‰æ˜¯å¦å¯ç”¨swagger-ui</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">docket <span class="token operator">=</span> docket<span class="token punctuation">.</span><span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ï¼ˆ4ï¼‰ä¸ºswagger2é…ç½®æœ‰å…³äºJWTçš„ç›¸å…³é…ç½®</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Docket</span> <span class="token function">securitySchemes</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">SecurityScheme</span><span class="token punctuation">&gt;</span></span> securitySchemes<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Docket</span> <span class="token function">securityContexts</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SecurityContext</span><span class="token punctuation">&gt;</span></span> securityContexts<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ï¼ˆ5ï¼‰é…ç½®swagger2æ‰«ææ–¹å¼ï¼ˆæ‰«æçš„ä½ç½®ï¼Œå†…å®¹ã€‚ã€‚ã€‚ï¼‰</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**ç”Ÿæˆæ‰«æé€‰æ‹©å™¨*/</span>
<span class="token class-name">ApiSelectorBuilder</span> selectorBuilder <span class="token operator">=</span> docket<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**é€‰æ‹©æ‰«æçš„æ–¹å¼*/</span>
selectorBuilder <span class="token operator">=</span> selectorBuilder<span class="token punctuation">.</span><span class="token function">apis</span><span class="token punctuation">(</span><span class="token class-name">RequestHandlerSelectors</span><span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**é€‰æ‹©æ‰«æçš„è·¯å¾„*/</span>
selectorBuilder <span class="token operator">=</span> selectorBuilder<span class="token punctuation">.</span><span class="token function">paths</span><span class="token punctuation">(</span><span class="token class-name">PathSelectors</span><span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**å»ºé€ Docketå¯¹è±¡*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210527141119.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio/imgs1/20210527141118.png"></p>
<p>ä¸‹é¢éœ€è¦å­¦ä¹ çš„å°±æ˜¯swagger2å¸¸ç”¨çš„æ³¨è§£ï¼Œä»¥åŠä½œç”¨ï¼š</p>
<h2 id="æ¨¡æ¿å¼•æ“"><a href="#æ¨¡æ¿å¼•æ“" class="headerlink" title="æ¨¡æ¿å¼•æ“"></a>æ¨¡æ¿å¼•æ“</h2><p><code>freemarker</code>ï¼šæ¨¡æ¿å¼•æ“ï¼Œå³ä¸€ç§åŸºäºæ¨¡æ¿å’Œè¦æ”¹å˜çš„æ•°æ®ï¼Œ å¹¶ç”¨æ¥ç”Ÿæˆè¾“å‡ºæ–‡æœ¬(HTMLç½‘é¡µï¼Œç”µå­é‚®ä»¶ï¼Œé…ç½®æ–‡ä»¶ï¼Œæºä»£ç ç­‰)çš„é€šç”¨å·¥å…·ã€‚ å®ƒä¸æ˜¯é¢å‘æœ€ç»ˆç”¨æˆ·çš„ï¼Œè€Œæ˜¯ä¸€ä¸ªJavaç±»åº“ï¼Œæ˜¯ä¸€æ¬¾ç¨‹åºå‘˜å¯ä»¥åµŒå…¥ä»–ä»¬æ‰€å¼€å‘äº§å“çš„ç»„ä»¶ã€‚</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!---å¼•æ“ä¾èµ–---&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-freemarker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>SpringBootå…³äºfreemarkerçš„é…ç½®</code>ï¼š</p>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">freemarker</span><span class="token punctuation">:</span>
    <span class="token key atrule">cache</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">allow-request-override</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">allow-session-override</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">charset</span><span class="token punctuation">:</span> UTF<span class="token punctuation">-</span><span class="token number">8</span>
    <span class="token key atrule">check-template-location</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">content-type</span><span class="token punctuation">:</span> text/html
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">expose-request-attributes</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">expose-session-attributes</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">expose-spring-macro-helpers</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">prefer-file-system-access</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">prefix</span><span class="token punctuation">:</span> master
    <span class="token key atrule">suffix</span><span class="token punctuation">:</span> .ftl
    <span class="token key atrule">template-loader-path</span><span class="token punctuation">:</span> classpath/templates/
    <span class="token key atrule">view-names</span><span class="token punctuation">:</span> mate
    <span class="token key atrule">request-context-attribute</span><span class="token punctuation">:</span> mate
    <span class="token key atrule">settings</span><span class="token punctuation">:</span> mate<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<ul>
<li>==æ¨¡æ¿å¼•æ“ + æ•°æ®æ¨¡å‹ = è¾“å‡ºhtmlæ–‡ä»¶==</li>
</ul>
<img src="https://cdn.jsdelivr.net/gh/matemaster9/ali-note/md/20210629201216.png" style="zoom:80%;">



<p>FreeMarkeræ•°æ®æ¨¡å‹çš„æ¦‚å¿µï¼š</p>
<blockquote>
<p><code>DataModel</code></p>
<ul>
<li>å“ˆå¸Œè¡¨</li>
</ul>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">animals</span><span class="token punctuation">:</span>
<span class="token key atrule">mouse</span><span class="token punctuation">:</span>
 <span class="token key atrule">size</span><span class="token punctuation">:</span> <span class="token number">100</span>
 <span class="token key atrule">price</span><span class="token punctuation">:</span> <span class="token number">10000</span>
	<span class="token key atrule">date</span><span class="token punctuation">:</span> 2021<span class="token punctuation">-</span>6<span class="token punctuation">-</span><span class="token number">29</span>

<span class="token key atrule">elephant</span><span class="token punctuation">:</span>
 <span class="token key atrule">size</span><span class="token punctuation">:</span> <span class="token number">100</span>
 <span class="token key atrule">price</span><span class="token punctuation">:</span> <span class="token number">10000</span>

<span class="token key atrule">python</span><span class="token punctuation">:</span>
 <span class="token key atrule">size</span><span class="token punctuation">:</span> <span class="token number">100</span>
 <span class="token key atrule">price</span><span class="token punctuation">:</span> <span class="token number">10000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç±»ä¼¼æ–‡ä»¶æ ‘çš„æ•°æ®æ¨¡å‹ç»“æ„ï¼Œå˜é‡åœ¨è¿™é‡Œç›¸å½“äºç›®å½•çš„è§’è‰²ã€‚å¯ä»¥å­˜å‚¨å­å˜é‡çš„ç»“æ„ç§°ä¸º<strong>å“ˆå¸Œè¡¨</strong>ï¼Œæ¯ä¸€ä¸ªå­˜å‚¨å•å€¼çš„å˜é‡æˆä¸º<strong>æ ‡é‡</strong>ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ©ç”¨åç§°å»è·å–å˜é‡ã€‚</p>
<ul>
<li>åºåˆ—</li>
</ul>
<pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">animals</span><span class="token punctuation">:</span>
  <span class="token key atrule">1st</span><span class="token punctuation">:</span>
    <span class="token key atrule">size</span><span class="token punctuation">:</span> <span class="token number">100</span>
    <span class="token key atrule">price</span><span class="token punctuation">:</span> <span class="token number">10000</span>

  <span class="token key atrule">2nd</span><span class="token punctuation">:</span>
    <span class="token key atrule">size</span><span class="token punctuation">:</span> <span class="token number">100</span>
    <span class="token key atrule">price</span><span class="token punctuation">:</span> <span class="token number">10000</span>

  <span class="token key atrule">3rd</span><span class="token punctuation">:</span>
    <span class="token key atrule">size</span><span class="token punctuation">:</span> <span class="token number">100</span>
    <span class="token key atrule">price</span><span class="token punctuation">:</span> <span class="token number">10000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ä¸Šé¢æ–‡ä»¶æ ‘ç»“æ„ä¸­çš„å­å˜é‡æ²¡æœ‰åç§°ï¼Œåªæ˜¯å•çº¯çš„åˆ—è¡¨çš„é¡¹ï¼Œé‚£ä¹ˆè¯¥ç»“æ„å°±æ˜¯åºåˆ—ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®ç´¢å¼•è·å–å˜é‡ã€‚</p>
<p>æ€»ç»“ï¼š</p>
<p>â€“ æ•°æ®æ¨¡å‹ç±»ä¼¼äºæ–‡ä»¶ç›®å½•æ ‘ç»“æ„ã€‚<br>â€“ æ ‡é‡ï¼šç”¨äºå­˜å‚¨å•å€¼çš„å˜é‡ã€‚æœ‰ï¼šå­—ç¬¦ä¸²ã€æ—¥æœŸæ—¶é—´ã€å¸ƒå°”å€¼ã€æ•°å­—<br>â€“ å“ˆå¸Œè¡¨ï¼šå¯ä»¥å­˜å‚¨å­å˜é‡ï¼Œå¹¶ä¸”ä¾æ®åç§°è·å–<br>â€“ åºåˆ—ï¼šå¯ä»¥å­˜å‚¨å­å˜é‡ï¼Œå¹¶ä¸”ä¾æ®ç´¢å¼•è·å–</p>
</blockquote>
<p style="background-color:yellowgreen">FreeMarkeræ”¯æŒçš„æ•°æ®ç±»å‹</p>

<ul>
<li><p>æ ‡é‡</p>
<ul>
<li>å­—ç¬¦ä¸²</li>
<li>æ•°å€¼</li>
<li>æ—¥æœŸ/æ—¶é—´ï¼šä¸å¯ç›´æ¥è¾“å‡ºï¼Œéœ€è¦è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</li>
<li>å¸ƒå°”å€¼ï¼šä¸å¯ç›´æ¥è¾“å‡ºï¼Œéœ€è¦è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</li>
</ul>
</li>
<li><p>å®¹å™¨</p>
<ul>
<li>å“ˆå¸Œè¡¨</li>
<li>åºåˆ—ï¼šï¼ˆlistã€æ•°ç»„ã€setï¼‰</li>
<li>é›†åˆï¼šæœ‰é™çš„åºåˆ—</li>
</ul>
</li>
</ul>
<p style="background-color:yellowgreen">FreeMarkerçš„æ¨¡æ¿å¼•æ“è¯­æ³•ï¼šFTLæ ‡ç­¾ + æ’å€¼</p>

<p><code>å®˜æ–¹çš„FTLæ ‡ç­¾æ ¼å¼</code>ï¼š&lt;# &gt;ã€‚ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰æ ‡ç­¾ï¼š&lt;@ &gt;ã€‚æ³¨é‡Šæ ¼å¼ï¼š&lt;#â€“ â€“&gt;ã€‚æ’å€¼ï¼š${value}</p>
<p>ftlå¤„ç†Javaä¸­çš„nullæˆ–è€…æ˜¯ä¸€ä¸ªæ ¹æœ¬ä¸å­˜åœ¨çš„å€¼</p>
<p>â€‹    <code>var!default</code>ï¼Œç”¨äºæŒ‡å®šå½“è¯¥æ’å€¼varæ˜¯ä¸ªnullæˆ–è€…å‹æ ¹ä¸å­˜åœ¨æ—¶ï¼Œæ‰€æ›¿ä»£çš„å€¼</p>
<p>â€‹    <code>??</code>ï¼Œç”¨äºåˆ¤æ–­å½“å‰æ’å€¼æ˜¯å¦å­˜åœ¨ï¼Œè¿”å›trueæˆ–false</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>${var!"default"}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#if</span> <span class="token attr-name">existence??</span><span class="token punctuation">&gt;</span></span>
        è¿™ä¸ªå€¼å­˜åœ¨æ—¶çš„æ“ä½œ
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#else</span> <span class="token punctuation">&gt;</span></span> 
        è¿™ä¸ªå€¼æ ¹æœ¬ä¸å­˜åœ¨
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#if</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>åºåˆ—ç±»å‹ï¼Œ&lt;#list &gt;æŒ‡ä»¤éå†åºåˆ—</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#list</span> <span class="token attr-name">companies</span> <span class="token attr-name">as</span> <span class="token attr-name">company</span> <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>ä¸‹æ ‡ï¼š${company?index} å…¬å¸ï¼š${company}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#list</span><span class="token punctuation">&gt;</span></span>

${companies?first} ï¼šè·å–åºåˆ—çš„ç¬¬ä¸€ä¸ªå­å˜é‡
${companies?last}ï¼šè·å–åºåˆ—çš„æœ€åä¸€ä¸ªå­å˜é‡
${companies?size}ï¼šè·å–åºåˆ—çš„é•¿åº¦<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>å“ˆå¸Œç±»å‹çš„ä¸¤ç§éå†æ–¹å¼ï¼škeyéå†ã€valueéå†</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#list</span> <span class="token attr-name">hash?keys</span> <span class="token attr-name">as</span> <span class="token attr-name">key</span><span class="token punctuation">&gt;</span></span>
	${key}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#list</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#list</span> <span class="token attr-name">hash?values</span> <span class="token attr-name">as</span> <span class="token attr-name">value</span><span class="token punctuation">&gt;</span></span>
	${value}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#list</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>ftlä¸­å¸¸ç”¨çš„æŒ‡ä»¤</p>
<ul>
<li>åœ¨æ¨¡æ¿é¡µé¢ä¸Šè‡ªå®šä¹‰å˜é‡ï¼š&lt;#assign &gt;</li>
<li>é€»è¾‘åˆ¤æ–­çš„æŒ‡ä»¤ï¼š&lt;#if &gt;ã€&lt;#elseif &gt;ã€&lt;#else &gt;</li>
<li>macroè‡ªå®šä¹‰æŒ‡ä»¤ï¼ˆå®ï¼‰</li>
<li>nestedå ä½ç¬¦æŒ‡ä»¤</li>
<li>importå¯¼å…¥æŒ‡ä»¤</li>
<li>includeæŒ‡ä»¤ï¼šç”¨äºåœ¨æ¨¡æ¿æ–‡ä»¶ä¸­å¼•å…¥å…¶ä»–çš„æ–‡ä»¶htmlã€ftlã€txtâ€¦â€¦</li>
</ul>
<p>ç”¨äºé€»è¾‘åˆ¤æ–­</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html">é€»è¾‘åˆ¤æ–­æŒ‡ä»¤
    æ ¼å¼ï¼š
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#if</span> <span class="token attr-name">condition</span><span class="token punctuation">&gt;</span></span>
        
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#elseif</span> <span class="token attr-name">condition2</span><span class="token punctuation">&gt;</span></span>
        
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#else</span><span class="token punctuation">&gt;</span></span>
        
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#if</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>éå†åºåˆ—</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html">listæŒ‡ä»¤
æ ¼å¼1ï¼š
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#list</span> <span class="token attr-name">sequence</span> <span class="token attr-name">as</span> <span class="token attr-name">item</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#list</span><span class="token punctuation">&gt;</span></span>
æ ¼å¼2ï¼š
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#list</span> <span class="token attr-name">sequence</span> <span class="token attr-name">as</span> <span class="token attr-name">item</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#else</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#list</span><span class="token punctuation">&gt;</span></span>

    æ³¨ï¼šsequenceæ˜¯åºåˆ—çš„åç§°ï¼Œitemæ˜¯å•ä¸ªå¼•ç”¨    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è‡ªå®šä¹‰è‡ªå·±çš„æŒ‡ä»¤</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#macro</span> <span class="token attr-name">print</span><span class="token punctuation">&gt;</span></span>
    è¿™ä¸ªæ˜¯diyçš„printæŒ‡ä»¤
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#macro</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>@print</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>@print</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#macro</span> <span class="token attr-name">printf</span> <span class="token attr-name">param1</span> <span class="token attr-name">param2</span><span class="token punctuation">&gt;</span></span>
    ç”¨æˆ·åï¼š${param1}----å¯†ç ${param2}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#macro</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>@printf</span> <span class="token attr-name">"MateMaster"</span> <span class="token attr-name">"password"</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>@printf</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨è‡ªå®šä¹‰æŒ‡ä»¤ä¸­ï¼Œä½¿ç”¨å ä½ç¬¦</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#macro</span> <span class="token attr-name">æŒ‡ä»¤åç§°</span> <span class="token attr-name">å‚æ•°åˆ—è¡¨</span><span class="token punctuation">&gt;</span></span>
    ç”¨æˆ·åï¼š${param1}----å¯†ç ${param2}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#nested</span> <span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#macro</span><span class="token punctuation">&gt;</span></span>
    
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>@æŒ‡ä»¤</span> <span class="token attr-name">å‚æ•°åˆ—è¡¨</span><span class="token punctuation">&gt;</span></span>è°ƒç”¨æŒ‡ä»¤æ—¶ nestedå ä½ç¬¦æ˜¾ç¤ºçš„å†…å®¹<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>@æŒ‡ä»¤</span><span class="token punctuation">&gt;</span></span>    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è‡ªå®šä¹‰çš„ä¹˜æ³•è¡¨æŒ‡ä»¤ï¼š<code>common.ftl</code></p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#macro</span> <span class="token attr-name">multiplication</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#list</span> <span class="token attr-name">1..9</span> <span class="token attr-name">as</span> <span class="token attr-name">i</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#list</span> <span class="token attr-name">1..i</span> <span class="token attr-name">as</span> <span class="token attr-name">j</span><span class="token punctuation">&gt;</span></span>
            ${j} * ${i} = ${j*i} <span class="token entity named-entity" title="&nbsp;">&amp;nbsp;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#list</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#list</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#macro</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨åˆ«çš„ftlæ–‡ä»¶ä¸­ï¼Œé€šè¿‡importæŒ‡ä»¤å»è°ƒç”¨è¿™ä¸ªè‡ªå®šä¹‰çš„ä¹˜æ³•è¡¨æŒ‡ä»¤</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#import</span> <span class="token attr-name">"common.ftl"</span> <span class="token attr-name">as</span> <span class="token attr-name">common</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>@common.multiplication</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>@common.multiplication</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<p><code>freemarkeræŒ‡ä»¤å‚è€ƒ</code>ï¼š</p>
<blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_assign.html">assign</a>ï¼šå®šä¹‰å˜é‡</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_attempt.html">attempt, recover</a>ï¼šå¼‚å¸¸å¤„ç†</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_compress.html">compress</a>ï¼šä»£ç å‹ç¼©</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_escape.html">escape, noescape</a></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_flush.html">flush</a></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_ftl.html">ftl</a></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_function.html">function, return</a>ï¼šå‡½æ•°å®šä¹‰</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_global.html">global</a></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_if.html">if, else, elseif</a>ï¼šé€»è¾‘åˆ¤æ–­</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_import.html">import</a>ï¼šå¼•ç”¨å‘½åç©ºé—´</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_include.html">include</a>ï¼šå¼•ç”¨æ–‡ä»¶</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_list.html">list, else, items, sep, break</a>ï¼šå¾ªç¯ç»“æ„</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_local.html">local</a>ï¼šå±€éƒ¨å˜é‡ï¼Œç±»ä¼¼assign</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_macro.html">macro, nested, return</a>ï¼šå®å®šä¹‰ï¼ˆdiyæŒ‡ä»¤ï¼‰</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_noparse.html">noparse</a></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_nt.html">nt</a></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_setting.html">setting</a></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_stop.html">stop</a></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_switch.html">switch, case, default, break</a>ï¼šé€‰æ‹©ç»“æ„</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_t.html">t, lt, rt</a>ï¼šå»é™¤ç©ºæ ¼</li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_userDefined.html">User-defined directive (&lt;@â€¦&gt;)</a></li>
<li><a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/ref_directive_visit.html">visit, recurse, fallback</a></li>
</ul>
</blockquote>
<p>è¡¨è¾¾å¼ï¼š</p>
<p>å­—ç¬¦ä¸²è¡¨è¾¾å¼ï¼Œâ€stringâ€ â€˜stringâ€™éƒ½å¯ä»¥ã€‚å¹¶ä¸”å­—ç¬¦ä¸²è¡¨è¾¾å¼å¯ä»¥ç›´æ¥å­˜åœ¨äºæ¨¡æ¿ä¸­ï¼Œéœ€è¦æ³¨æ„è½¬ä¹‰å­—ç¬¦</p>
<table>
<thead>
<tr>
<th align="left">è½¬ä¹‰åºåˆ—</th>
<th align="left">å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>\"</code></td>
<td align="left">å¼•å· (u0022)</td>
</tr>
<tr>
<td align="left"><code>\'</code></td>
<td align="left">å•å¼•å·(åˆç§°ä¸ºæ’‡å·) (u0027)</td>
</tr>
<tr>
<td align="left"><code>\{</code></td>
<td align="left">èµ·å§‹èŠ±æ‹¬å·ï¼š<code>{</code></td>
</tr>
<tr>
<td align="left"><code>\\</code></td>
<td align="left">åæ–œæ  (u005C)</td>
</tr>
<tr>
<td align="left"><code>\n</code></td>
<td align="left">æ¢è¡Œç¬¦ (u000A)</td>
</tr>
<tr>
<td align="left"><code>\r</code></td>
<td align="left">å›è½¦ (u000D)</td>
</tr>
<tr>
<td align="left"><code>\t</code></td>
<td align="left">æ°´å¹³åˆ¶è¡¨ç¬¦(åˆç§°ä¸ºtab) (u0009)</td>
</tr>
<tr>
<td align="left"><code>\b</code></td>
<td align="left">é€€æ ¼ (u0008)</td>
</tr>
<tr>
<td align="left"><code>\f</code></td>
<td align="left">æ¢é¡µ (u000C)</td>
</tr>
<tr>
<td align="left"><code>\l</code></td>
<td align="left">å°äºå·ï¼š<code>&lt;</code></td>
</tr>
<tr>
<td align="left"><code>\g</code></td>
<td align="left">å¤§äºå·ï¼š<code>&gt;</code></td>
</tr>
<tr>
<td align="left"><code>\a</code></td>
<td align="left">&amp;ç¬¦ï¼š<code>&amp;</code></td>
</tr>
<tr>
<td align="left"><code>\xCode</code></td>
<td align="left">å­—ç¬¦çš„16è¿›åˆ¶ <a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/gloss.html#gloss.unicode">Unicode</a> ç  (<a target="_blank" rel="noopener" href="http://freemarker.foofun.cn/gloss.html#gloss.UCS">UCS</a> ç )</td>
</tr>
</tbody></table>
<p>æ•°å­—è¡¨è¾¾å¼ï¼šå¯ä»¥è¡¨ç¤ºä»»æ„ç±»å‹çš„æ•°å­—</p>
<p>å¸ƒå°”å€¼ï¼štrueæˆ–falseï¼Œæ’å€¼ä¸­æˆ‘ä»¬ä¸å¯ä»¥ç›´æ¥æ¥å—å¸ƒå°”å˜é‡ï¼Œä½†æ˜¯å¯ä»¥æ˜¾å¼ä½¿ç”¨trueå’Œfalse</p>
<p>åºåˆ—ï¼šæ ¼å¼ä¸€èˆ¬ä¸º<code>["HUAWEI", "Alibaba", "Apple", "IBM"]</code></p>
<p>å€¼åŸŸè¡¨è¾¾å¼ï¼šstart..endã€‚<code>å¼€å§‹å€¼..ç»“å°¾å€¼</code></p>
<p>â€‹    ä¸»è¦å­˜åœ¨ä¸‰ç§å½¢å¼ï¼š0..100ï¼Œ0..&lt;100æˆ–0..!100ï¼Œ0..*100ã€‚<br>â€‹    0.100ï¼š0åˆ°100 åŒ…å«0å’Œ100<br>â€‹    0..&lt;100æˆ–0..!100ï¼šè¡¨ç¤ºä¸åŒ…å«100<br>â€‹    0..*100ï¼šä»0å¼€å§‹ï¼Œä¸€å…±100ä¸ªæ•°</p>
<p>å“ˆå¸Œè¡¨è¡¨è¾¾å¼ï¼šä¸€èˆ¬æ ¼å¼ä¸º<code>{"å­å˜é‡åç§°":å­å˜é‡å€¼(ä»»æ„ç±»å‹)}</code>ã€‚è¯·æ³¨æ„åå’Œå€¼éƒ½æ˜¯è¡¨è¾¾å¼ï¼Œä½†æ˜¯ç”¨æ¥æ£€ç´¢çš„åç§°å°±å¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œ è€Œå€¼å¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚</p>
<p>å¦‚ä½•ä»å®¹å™¨ä¸­æ£€ç´¢å­å˜é‡çš„å€¼ï¼Ÿ</p>
<p>ç­”ï¼šå“ˆå¸Œè¡¨ä»¥åç§°è·å–ï¼Œå¦‚ï¼šcompany.nameã€‚åºåˆ—ä»¥ç´¢å¼•å€¼è·å–ï¼Œå¦‚ï¼šcompany[0]</p>
<p>æ’å€¼çš„è½¬æ¢è§„åˆ™ï¼š</p>
<ol>
<li>å¦‚æœè¿™ä¸ªå€¼æ˜¯æ•°å­—ï¼Œé‚£ä¹ˆå®ƒä¼šæŒ‰ç…§æŒ‡å®šçš„ <code>number_format</code> è®¾ç½®è§„åˆ™æ¥è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚æ‰€ä»¥è¿™äº›è½¬æ¢é€šå¸¸æ˜¯å¯¹ç”¨æˆ·è¿›è¡Œçš„ï¼Œè€Œä¸æ˜¯å¯¹è®¡ç®—æœºã€‚</li>
<li>å¦‚æœè¿™ä¸ªå€¼æ˜¯æ—¥æœŸï¼Œæ—¶é—´æˆ–æ—¶é—´æ—¥æœŸç±»å‹çš„ä¸€ç§ï¼Œé‚£ä¹ˆå®ƒä»¬ä¼šæŒ‰ç…§æŒ‡å®šçš„ <code>date_format</code>ï¼Œ <code>time_format</code> æˆ–è€… <code>datetime_format</code> è®¾ç½®è§„åˆ™æ¥è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚ å¦‚æœå®ƒä¸èƒ½è¢«æ¢æµ‹å‡ºæ¥æ˜¯å“ªç§æ—¥æœŸç±»å‹(æ—¥æœŸæˆ–æ—¶é—´æˆ–æ—¥æœŸæ—¶é—´)æ—¶ï¼Œå°±ä¼šå‘ç”Ÿé”™è¯¯äº†ã€‚</li>
<li>å¦‚æœå€¼æœ¬æ¥å°±æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„ï¼Œä¸éœ€è¦è½¬æ¢ã€‚</li>
<li>å¦‚æœ FreeMarker å¼•æ“åœ¨ä¼ ç»Ÿå…¼å®¹æ¨¡å¼ä¸‹ï¼š<ol>
<li>å¦‚æœå€¼æ˜¯å¸ƒå°”ç±»å‹ï¼Œtrueå€¼å°±è½¬æ¢æˆâ€trueâ€ï¼Œfalseå€¼å°†ä¼šè½¬æ¢ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</li>
<li>å¦‚æœè¡¨è¾¾å¼æœªè¢«å®šä¹‰(<code>null</code> æˆ–è€…å˜é‡æœªå®šä¹‰)ï¼Œ é‚£ä¹ˆå°±è½¬æ¢ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</li>
<li>å¦åˆ™å°±ä¼šå‘ç”Ÿé”™è¯¯ä¸­æ­¢æ¨¡æ¿æ‰§è¡Œã€‚</li>
</ol>
</li>
<li>å¦åˆ™å°±ä¼šå‘ç”Ÿé”™è¯¯ä¸­æ­¢æ¨¡æ¿æ‰§è¡Œã€‚</li>
</ol>
<p><code>freemarkerå†…å»ºå‡½æ•°</code>ï¼š</p>
<p>ï¼ˆ1ï¼‰æ ‡é‡å†…å»ºå‡½æ•°</p>
<p>â€“</p>
<p>è°ƒç”¨å‡½æ•°çš„æ•°æ®ç±»å‹æ˜¯ï¼šå­—ç¬¦ä¸²</p>
<ul>
<li>booleanã€numberã€dateã€timeã€datetimeï¼šä¸å…¶ä»–æ ‡é‡ç±»å‹çš„è½¬æ¢</li>
<li>cap_first/uncap_firstï¼šå•è¯é¦–å­—æ¯å¤§å†™/ä¸å¤§å†™</li>
<li>capitalizeï¼šé¦–å­—æ¯å¤§å†™ï¼Œå…¶ä½™å°å†™</li>
<li>starts_with/ends_withï¼šä»¥å­—ä¸²å¼€å¤´ç»“å°¾</li>
<li>ensure_starts_with/ensure_ends_withï¼šç¡®ä¿ä¸²æ˜¯ä»¥æŒ‡å®šå­—ä¸²å¼€å¤´ç»“å°¾</li>
<li>keep_after/keep_before/keep_after_last/keep_before_lastï¼šæˆªå–å­—ä¸²å‰åçš„å†…å®¹</li>
<li>index_of/last_index_ofï¼šå­—ä¸²å‡ºç°çš„ä½ç½®</li>
<li>left_pad/right_padï¼šå·¦å³å¡«å……</li>
<li>upper_case/lower_caseï¼šå¤§å°å†™</li>
</ul>
<p>â€“</p>
<p>è°ƒç”¨å‡½æ•°çš„æ•°æ®ç±»å‹æ˜¯ï¼šæ•°å€¼</p>
<ul>
<li>abs</li>
<li>c</li>
<li>is_infinite/is_nanï¼šåˆ¤æ–­æ— é™æˆ–è€…NaN</li>
<li>upper_abc/lower_abcï¼š123å¯¹åº”abcæˆ–ABC è¶…è¿‡26å°±æ˜¯aaæˆ–AA</li>
<li>round/floor/ceiling</li>
</ul>
<p>â€“</p>
<p>è°ƒç”¨å‡½æ•°çš„æ•°æ®ç±»å‹æ˜¯ï¼šå¸ƒå°”å€¼</p>
<ul>
<li>c</li>
<li>then</li>
<li>string</li>
</ul>
<p>â€“</p>
<p>è°ƒç”¨å‡½æ•°çš„æ•°æ®ç±»å‹æ˜¯ï¼šæ—¥æœŸæ—¶é—´</p>
<ul>
<li>date</li>
<li>time</li>
<li>datetimeï¼šç¡®å®šæ—¥æœŸå˜é‡ä½¿ç”¨çš„æ˜¯é‚£ä¸€éƒ¨åˆ†</li>
</ul>
<p>ï¼ˆ2ï¼‰å®¹å™¨å†…å»ºå‡½æ•°</p>
<p>â€“</p>
<p>åºåˆ—è°ƒç”¨çš„å‡½æ•°</p>
<ul>
<li>chunkï¼šåˆ†å‰²ä¸ºå­åºåˆ—</li>
<li>first/lastï¼šå­å˜é‡</li>
<li>join</li>
<li>size</li>
<li>reverse</li>
<li>sort</li>
<li>sort_byï¼šæŒ‰ç…§ç»™å®šçš„hashå­å˜é‡æ’åº</li>
<li>seq_containsï¼šæ˜¯å¦åŒ…å«å­åºåˆ—</li>
<li>seq_index_of</li>
<li>seq_last_index_ofï¼šå­åºåˆ—å‡ºç°çš„ä½ç½®</li>
</ul>
<p>â€“</p>
<p>å“ˆå¸Œè¡¨è°ƒç”¨çš„å‡½æ•°</p>
<ul>
<li>keysï¼šé”®éå†</li>
<li>valuesï¼šå€¼éå†</li>
</ul>
<p>ï¼ˆ3ï¼‰ç‹¬ç«‹å†…å»ºå‡½æ•°</p>
<p>â€“</p>
<p>ä½œç”¨äºå¾ªç¯å˜é‡çš„å‡½æ•°</p>
<ul>
<li>counterï¼šè®¡æ•°</li>
<li>has_nextï¼šæ˜¯å¦æœ‰ä¸‹ä¸€ä¸ª</li>
<li>index</li>
<li>is_first/is_last</li>
<li>is_even_item/is_odd_item</li>
<li>item_xxxï¼šitemç³»åˆ—å†…å»ºå‡½æ•°</li>
</ul>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        æœ¬æ–‡ä½œè€…:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">MateMaster</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        æœ¬æ–‡é“¾æ¥:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://www.matemaster.cn/posts/10711.html">https://www.matemaster.cn/posts/10711.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        ç‰ˆæƒå£°æ˜:
                    </i>
                </span>
                <span class="reprint-info">
                    æœ¬åšå®¢æ‰€æœ‰åˆ›ä½œæ–‡ç« é™¤ç‰¹åˆ¥å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ–‡ç« æ¥æº
                    <a href="/about" target="_blank">MateMaster</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copy æˆåŠŸï¼åˆ›ä½œä¸æ˜“ï¼Œè¯·éµå®ˆè½¬è½½è§„åˆ™ï¼Œè°¢è°¢é…åˆï¼</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">Look</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Spring/">
                                    <span class="chip bg-color">Spring</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">èµ</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">ä½ çš„èµèµæ˜¯æˆ‘æœ€å¤§çš„åˆ›ä½œåŠ¨åŠ›</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">æ”¯ä»˜å®</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">å¾® ä¿¡</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>è¯„è®º</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="https://unpkg.com/valine/dist/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: 'YrRjwBqQayBV1KtKfWSC8etE-gzGzoHsz',
        appKey: '9FUwrOjImG1EmrWuwDMed0MP',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'hide',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: 'è¯·ç•™è¨€'
    });
</script>

<!--é…·Qæ¨é€-->


    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div>
            <div class="card">
                <a href="/posts/9622.html">
                    <div class="card-image">
                        
                        <img src="https://cdn.jsdelivr.net/gh/matemaster9/image-one/images/20210317194803.jpg" class="responsive-img" alt="åšå®¢æ–‡ç« å¯¼èˆª">
                        
                        <span class="card-title">åšå®¢æ–‡ç« å¯¼èˆª</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            åšå®¢æ–‡ç« é“¾æ¥
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-03-14
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/MasterStudio/" class="post-category">
                                    MasterStudio
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%8E%9F%E5%88%9B/">
                        <span class="chip bg-color">åŸåˆ›</span>
                    </a>
                    
                    <a href="/tags/MasterStudio/">
                        <span class="chip bg-color">MasterStudio</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                ä¸‹ä¸€ç¯‡&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/posts/22726.html">
                    <div class="card-image">
                        
                        <img src="https://cdn.jsdelivr.net/gh/matemaster9/imgs-masterstudio@1.3/imgs1/20210407121041.png" class="responsive-img" alt="Spring5å®æˆ˜">
                        
                        <span class="card-title">Spring5å®æˆ˜</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Spring5å®æˆ˜å­¦ä¹ ç¬”è®°
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-09-21
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/SpringFramework/" class="post-category">
                                    SpringFramework
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Spring/">
                        <span class="chip bg-color">Spring</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- ä»£ç å—åŠŸèƒ½ä¾èµ– -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- ä»£ç è¯­è¨€ -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- ä»£ç å—å¤åˆ¶ -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- ä»£ç å—æ”¶ç¼© -->


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;ç›®å½•</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC æ‚¬æµ®æŒ‰é’®. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/js/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('1'),
            headingSelector: 'h1, h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021</span>
            
            <span id="year">2021</span>
            <a href="/about" target="_blank">MateMaster</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;ç«™ç‚¹æ€»å­—æ•°:&nbsp;<span
                class="white-color">133.2k</span>&nbsp;å­—
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;æ€»è®¿é—®é‡:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;æ¬¡
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;æ€»è®¿é—®äººæ•°:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;äºº
            </span>
            
            <br>
            
            <span id="sitetime">è½½å…¥è¿è¡Œæ—¶é—´...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2021";
                    var startMonth = "3";
                    var startDate = "14";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "æœ¬ç«™å·²å®‰å…¨è¿è¡Œ " + diffDays + " å¤© " + diffHours +
                            " å°æ—¶ " + diffMinutes + " åˆ†é’Ÿ " + diffSeconds + " ç§’";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "æœ¬ç«™å·²å®‰å…¨è¿è¡Œ " + diffYears + " å¹´ " + diffDays +
                            " å¤© " + diffHours + " å°æ—¶ " + diffMinutes + " åˆ†é’Ÿ " + diffSeconds + " ç§’";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
            <span id="icp"><img src="/medias/icp.png" style="vertical-align: text-bottom;" />
                <a href="/" target="_blank">çš–ICPå¤‡2021003646å·</a>
            </span>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/matemaster9" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
        <i class="fas fa-code-branch"></i>
    </a>



    <a href="mailto:matemaster@163.com" class="tooltipped" target="_blank" data-tooltip="mailto MateMaster" data-position="top" data-delay="50">
        <i class="fas fa-at"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=35679808" class="tooltipped" target="_blank" data-tooltip="QQè”ç³»æˆ‘: 35679808" data-position="top" data-delay="50">
        <i class="fab fa-quora"></i>
    </a>





    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…æˆ‘" data-position="top" data-delay="50">
        <i class="far fa-star"></i>
    </a>



    <a href="https://gitee.com/matemaster" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„Gitee" data-position="top" data-delay="50">
        <i class="fab fa-git"></i>
    </a>



    <a href="https://www.zhihu.com/people/matemaster" class="tooltipped" target="_blank" data-tooltip="æ¬¢è¿è®¿é—®æˆ‘çš„çŸ¥ä¹ä¸»é¡µ" data-position="top" data-delay="50">
        <i class="fab fa-zhihu"></i>
    </a>




</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/js/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/js/masonry.pkgd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/js/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/js/scrollProgress.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/js/lightgallery-all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/js/matery.js"></script>

    <!-- Baidu Analytics -->

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?3bf42384074a5ca62d1c637c8cf1012f";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/js/clicklove.js" async="async"></script>
    
    
    <script async src="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/js/busuanzi.pure.mini.js"></script>
    

    

    

    <!--è…¾è®¯å…”å°å·¢-->
    
    

    

    

    
    <script src="https://cdn.jsdelivr.net/gh/matemaster9/source@2.0/matery-libs/js/instantpage.js" type="module"></script>
    

</body>

</html>
